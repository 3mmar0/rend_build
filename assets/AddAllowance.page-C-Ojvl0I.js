import{r as a,j as e,e as g,t as A,k as D,L as C,m as _}from"./index-BYyXun5x.js";import{a as F,b as v}from"./axios-utils-AvuZ81CO.js";import{U as I}from"./UnderlineHeading-ByjNC2ge.js";import{P as k}from"./PrimaryButton-CZnRZgcz.js";import{A as T}from"./AddIcon-B_YFP14b.js";import{U as P}from"./UserEditIcon-Ds9vpXTs.js";import{D as q,a as U,b as L}from"./dialog-CC_6CGm6.js";import{z as n,u as M,t as K,F as B}from"./index-C2_QJ2lf.js";import{S as G}from"./SecondaryButton-DL_Bkgwn.js";import{S as H}from"./SearchableSelectInputForm-v1_SI72T.js";import{D as R}from"./DayPickerInputForm-BVMb7yWz.js";import{S as z}from"./SelectInputForm-CG_Opxs4.js";import{T as w}from"./TextInputForm-DXNY8AYK.js";import{f as J}from"./format-D6Kkl3rb.js";import{T as O}from"./TrashIcon-YH55CqcU.js";import{D as V}from"./data-table-G-GPousO.js";import{S as Q}from"./StatisticsCards-B_8i9ipX.js";import{P as W,T as X}from"./TwoUsersIcon-W4p4rWJZ.js";import{U as Y}from"./UserMinusIcon-P_9JR1Tm.js";import{U as Z}from"./UserRemoveIcon-W72gV8qt.js";import"./Combination-cklTRtAe.js";import"./index-CV4wEvKw.js";import"./index-CLYNl1a9.js";import"./select-779NlImg.js";import"./index-Gk0NKYh3.js";import"./popover-BWwxYxvp.js";import"./chevron-right-CymCusjh.js";import"./chevron-left-DVnc3BG0.js";import"./CalendarIcon-ChMYIy2j.js";import"./table-Dfhf1Bk7.js";import"./CustomPagination-BD2pf3AX.js";import"./pagination-DR230PoL.js";const $=n.object({employee_id:n.string().min(1,"Employee name field is required."),date:n.date({required_error:"Date is required"}),allowance_type:n.string().min(1,"Allowance type is required"),name:n.string().min(1,"Name is required"),status:n.string().min(1,"Status is required"),amount:n.string().min(1,"Amount is required")});function ee({employee:t,setAddAllowance:s}){const[c,o]=a.useState(null),[d,r]=a.useState(!1),[h,u]=a.useState([]),[b,i]=a.useState(null),l=a.useMemo(()=>({employee_id:""}),[t]),j=M({resolver:K($),defaultValues:l}),E=async y=>{var f,x;r(!0),o(null);const N={...y,date:J(y.date,"yyyy-MM-dd")};try{await F({endpoint:t?g.allowance.update+t.id:g.allowance.create,body:N,config:{headers:{"Content-Type":"multipart/form-data"}}}),A("تم اضافة البدل بنجاح"),s(!1)}catch(p){if((x=(f=p.response)==null?void 0:f.data)!=null&&x.errors)Object.entries(p.response.data.errors).forEach(([m,S])=>{j.setError(m,{type:"manual",message:S.join(", ")})});else{let m="حدث خطأ أثناء إرسال البيانات. يرجى المحاولة مرة أخرى.";p.response?m=p.response.data.msg||m:p.request&&(m="تعذر الاتصال بالخادم. يرجى التحقق من اتصالك بالإنترنت."),o(m)}}finally{r(!1)}};return a.useEffect(()=>{(async()=>{try{const f=(await v({endpoint:g.employee.list})).data.data.data.map(x=>({name:x.name,value:String(x.id)}));u(f),i(null)}catch{i("Error fetching employees. Please try again later.")}})()},[]),e.jsx(e.Fragment,{children:e.jsx(B,{...j,children:e.jsxs("form",{onSubmit:j.handleSubmit(E),className:"mt-6",children:[c&&e.jsx("div",{className:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"",children:c}),e.jsx("button",{onClick:()=>o(null),className:"text-red-700 hover:text-red-900",children:"×"})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-6",children:[e.jsx(w,{name:"name",label:"اسم البدل",placeholder:"نوع البدل - تامينات - ساعات اضافية"}),e.jsx(z,{name:"allowance_type",options:[{name:"بدل",value:"allowances"},{name:"خصومات",value:"deductions"}],label:"نوع البدل",placeholder:"ادخل نوع البدل"}),e.jsx(w,{name:"amount",type:"number",label:"المبلغ",placeholder:"300"}),e.jsx(R,{name:"date",label:"التاريخ",placeholder:"2025/04/30"}),e.jsx(w,{name:"status",label:"الحالة",placeholder:"ادخل الحالة"}),e.jsx(H,{name:"employee_id",placeholder:"بحث عن اسم أو كود العميل",label:"اسم العميل",options:h,error:b,data:!0})]}),e.jsxs("div",{className:"flex flex-row gap-4 mt-12",children:[e.jsx(G,{onClick:()=>s(!1),type:"button",className:"w-full text-base leading-5 tracking-normal py-[10px] font-medium",children:"إلغاء"}),e.jsx(k,{type:"submit",className:"w-full text-base leading-5 tracking-normal font-medium py-[10px]",children:d?"جاري الحفظ...":"حفظ"})]})]})})})}function te({open:t,setAddAllowance:s}){return e.jsxs(q,{open:t,children:[e.jsx("div",{className:D("fixed inset-0 bg-black/50",{"!hidden":!t})}),e.jsxs(U,{showCloseButton:!1,className:"max-w-[623px] rounded-lg p-8 bg-white-blue-50 font-cairo gap-0 [&_[aria-label=Close]]:opacity-0",children:[e.jsxs(L,{className:"flex flex-col items-center",children:[e.jsx("div",{className:"flex flex-row justify-between mb-4 w-full",children:e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx(P,{}),e.jsx("h3",{className:"text-[22px] font-bold text-primery-blue-500",children:"اضافة بدل"})]})}),e.jsx("div",{className:"w-full border-b border-[#D1D1D1] !mt-0"})]}),e.jsx(ee,{setAddAllowance:s})]})]})}function ae({globalFilter:t,setGlobalFilter:s,filters:c,setFilters:o}){const[d,r]=a.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col p-2 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx(I,{text:"اضافة بدل"}),e.jsx("div",{className:"flex flex-row items-center gap-4",children:e.jsx("div",{children:e.jsxs(k,{onClick:()=>r(!0),className:"text-base px-[14px] xl:py-2 leading-5 font-semibold font-cairo tracking-normal",children:[e.jsx(T,{}),e.jsx("p",{className:"text-xs tracking-normal font-normal leading-[22.49px]",children:"اضافة بدل"})]})})})]}),e.jsx(te,{open:d,setAddAllowance:r})]})}const se=({row:t})=>e.jsx("div",{className:"cursor-pointer flex justify-center",children:e.jsx(C,{to:"/human-resources/salaries-details/add-allowance",children:e.jsx(O,{className:"text-[#E81E1E]"})})}),re=[{accessorKey:"id",header:()=>e.jsx("div",{className:"text-sm text-nowrap px-4 py-3 !text-primery-blue-500 leading-[26.24px] font-semibold tracking-normal",children:"اسم البند"}),cell:({row:t})=>e.jsx("div",{className:"text-sm px-4 py-3 !text-primery-blue-500 leading-[26.24px] font-semibold tracking-normal",children:t.original.employee_number})},{accessorKey:"name",header:()=>e.jsx("div",{className:"text-sm text-nowrap px-4 py-3 !text-primery-blue-500 leading-[26.24px] font-semibold tracking-normal",children:"وصف"}),cell:({row:t})=>e.jsx("div",{className:"text-sm px-4 py-3 !text-primery-blue-500 leading-[26.24px] font-semibold tracking-normal",children:t.original.employee_number})},{accessorKey:"status",header:()=>e.jsx("div",{className:"text-sm px-4 py-3 !text-primery-blue-500 leading-[26.24px] font-semibold tracking-normal",children:"المبلغ"}),cell:({row:t})=>e.jsx("div",{className:"text-sm text-[#625E74] font-normal tracking-normal leading-[26.4px]",children:t.original.main_salary})},{accessorKey:"date",header:()=>e.jsx("div",{className:"text-sm text-nowrap px-4 py-3 !text-primery-blue-500 leading-[26.24px] font-semibold tracking-normal",children:"التاريخ"}),cell:({row:t})=>e.jsx("div",{className:"text-sm text-[#625E74] font-normal tracking-normal leading-[26.4px]",children:"22/10/2023"})},{id:"actions",header:()=>e.jsx("div",{className:"text-sm text-nowrap text-center px-4 py-3 !text-primery-blue-500 leading-[26.24px] font-semibold tracking-normal",children:"الاجراءات"}),cell:({row:t})=>e.jsx(se,{row:t})}];function le(){const[t,s]=a.useState([]),[c,o]=a.useState(0),[d,r]=a.useState(0),[h,u]=a.useState(!1),b=a.useCallback(async i=>{u(!0);try{const l=await v({endpoint:g.employee.list,queryParams:{page:i.pageIndex+1,...i.filters,search:i.globalFilter}});s(l.data.data.data),o(Math.ceil(l.data.data.pagination.total/10)),r(l.data.data.pagination.total)}catch(l){console.error("Error fetching data:",l)}finally{u(!1)}},[]);return e.jsx("div",{className:"mt-6 mb-20 rounded-lg border border-[#E8E7EA] shadow-[0px_4px_4px_-1px_#0C0C0D0D,0px_4px_4px_-1px_#0C0C0D1A]",children:e.jsx(V,{columns:re,data:t,pageCount:c,totalCount:d,onFetchData:b,DataTableToolbar:ae,isLoading:h})})}function ne(){return e.jsxs("div",{className:"flex flex-row items-start w-full mt-6 ",children:[e.jsxs("div",{className:"flex-2",children:[e.jsx("p",{className:"text-sm px-4 py-3 !text-primery-blue-500 leading-[26.24px] font-semibold tracking-normal bg-white-blue-100",children:"اسم الموظف"}),e.jsxs("div",{className:"flex flex-row justify-start items-center gap-4 text-sm px-4 py-3 text-primery-blue-500 leading-[26.24px] font-semibold tracking-normal",children:[e.jsx("img",{src:_,alt:"",className:"rounded-full w-10 h-10 object-cover"}),e.jsxs("div",{className:"flex flex-col gap-1 text-nowrap",children:[e.jsx("p",{className:"tracking-normal text-primery-blue-900 font-medium text-sm",children:"mohamed rehan"}),e.jsx("p",{className:"tracking-normal text-white-blue-800 font-normal text-sm",children:"المنصب والقسم"})]})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm px-4 py-3 !text-primery-blue-500 leading-[26.24px] font-semibold tracking-normal bg-white-blue-100",children:"كود الموظف"}),e.jsx("p",{className:"text-sm text-[#625E74] font-normal tracking-normal leading-[26.4px] p-4",children:"اسم الموظف"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm px-4 py-3 !text-primery-blue-500 leading-[26.24px] font-semibold tracking-normal bg-white-blue-100",children:"قسم الموظف"}),e.jsx("p",{className:"text-sm text-[#625E74] font-normal tracking-normal leading-[26.4px] p-4",children:"اسم الموظف"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm px-4 py-3 !text-primery-blue-500 leading-[26.24px] font-semibold tracking-normal bg-white-blue-100",children:"المسمى الوظيفي"}),e.jsx("p",{className:"text-sm text-[#625E74] font-normal tracking-normal leading-[26.4px] p-4",children:"اسم الموظف"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm px-4 py-3 !text-primery-blue-500 leading-[26.24px] font-semibold tracking-normal bg-white-blue-100",children:"تاريخ التعين"}),e.jsx("p",{className:"text-sm text-[#625E74] font-normal tracking-normal leading-[26.4px] p-4",children:"اسم الموظف"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm px-4 py-3 !text-primery-blue-500 leading-[26.24px] font-semibold tracking-normal bg-white-blue-100",children:"اجمالي الرواتب"}),e.jsx("p",{className:"text-sm text-[#625E74] font-normal tracking-normal leading-[26.4px] p-4",children:"اسم الموظف"})]})]})}function oe(){const t=[{text:"إجمالي الراتب",num:3e3,icon:e.jsx(W,{}),label:"ريال",percent:12},{text:"الحوافز و البدلات",num:500,icon:e.jsx(X,{}),label:"ريال",percent:0},{text:"الخصومات",num:100,icon:e.jsx(Y,{}),label:"ريال",percent:-.3},{text:"صافي الراتب",num:3400,icon:e.jsx(Z,{}),label:"ريال",percent:-.3}];return e.jsx(Q,{cards:t,numJustifyStart:!0})}function Be(){return e.jsxs("div",{className:"w-full mt-6 mb-20",children:[e.jsx(oe,{}),e.jsx(ne,{}),e.jsx(le,{})]})}export{Be as default};
//# sourceMappingURL=AddAllowance.page-C-Ojvl0I.js.map
