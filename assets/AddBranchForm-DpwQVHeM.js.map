{"version":3,"file":"AddBranchForm-DpwQVHeM.js","sources":["../../src/features/branch/components/addBranch/Heading.tsx","../../src/features/branch/forms/schemas/add-branch-schema.ts","../../src/features/branch/forms/addBranch/BranchInfo.tsx","../../src/features/branch/forms/addBranch/AddBranchForm.tsx"],"sourcesContent":["import MainHeading from '@/components/heading/MainHeading';\r\nimport UnderlineHeading from '@/components/heading/UnderlineHeading';\r\n\r\nconst Heading = () => {\r\n    return (\r\n        <div className=\"mb-6\">\r\n            <div className=\"flex flex-row justify-between mb-6\">\r\n                <UnderlineHeading text=\"اضافة فرع\" />\r\n                {/* <Link to=\"/maintenance/list\">\r\n                    <SubtleButton>رجوع</SubtleButton>\r\n                </Link> */}\r\n            </div>\r\n            <MainHeading text=\"المعلومات الأساسية\" />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Heading;\r\n","import { z } from 'zod';\r\n\r\nexport const AddBranchSchema = z.object({\r\n    name: z.string().min(1, 'Maintenance center name is required'),\r\n    area: z.string().min(1, 'Area is required'),\r\n    city: z.string().min(1, 'City is required'),\r\n    address: z.string().min(1, 'Address is required'),\r\n    phone: z\r\n        .string()\r\n        .min(1, 'رقم الهاتف مطلوب')\r\n        .refine((val) => /^\\d+$/.test(val), 'الرجاء إدخال أرقام فقط')\r\n        .refine((val) => val.length >= 8 && val.length <= 15, 'يجب أن يتكون رقم الهاتف من 8 إلى 15 رقم'),\r\n    status: z.enum(['active', 'not active'], {\r\n        required_error: 'Status is required',\r\n    }),\r\n});\r\n\r\nexport type AddBranchFormValues = z.infer<typeof AddBranchSchema>;\r\n","import SelectInputForm from '@/components/forms/SelectInputForm';\r\nimport TextInputForm from '@/components/forms/TextInputForm';\r\n\r\nexport default function BranchInfo() {\r\n    return (\r\n        <div className=\"mb-6 grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n            <TextInputForm name=\"name\" label=\"اسم الفرع\" placeholder=\"ادخل اسم مركز الصيانة\" />\r\n            <SelectInputForm\r\n                name=\"area\"\r\n                label=\"المنطفة\"\r\n                placeholder=\"المنطقة الشرقة\"\r\n                options={[\r\n                    { name: 'option1', value: 'option1' },\r\n                    { name: 'option2', value: 'option2' },\r\n                    { name: 'option3', value: 'option3' },\r\n                    { name: 'option4', value: 'option4' },\r\n                ]}\r\n            />\r\n            <TextInputForm name=\"city\" label=\"المدينة\" placeholder=\"الدمام\" />\r\n            <TextInputForm name=\"address\" label=\"عنوان الفرع\" placeholder=\"ادخل عنوان الفرع\" />\r\n            <TextInputForm\r\n                type=\"tel\"\r\n                name=\"phone\"\r\n                label=\"رقم التواصل\"\r\n                placeholder=\"ادخل رقم التواصل\"\r\n                className=\"[&>input]:text-end [&>input]:placeholder:text-end\"\r\n            />\r\n            <SelectInputForm\r\n                name=\"status\"\r\n                label=\"الحالة\"\r\n                placeholder=\"الشرقية\"\r\n                options={[{ name: 'متاح', value: 'active' }]}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n","import { Form } from '@/components/ui/form';\r\nimport { useForm } from 'react-hook-form';\r\nimport { zodResolver } from '@hookform/resolvers/zod';\r\nimport { PrimaryButton } from '@/components/buttons/PrimaryButton';\r\nimport { apiPost } from '@/lib/axios/axios-utils';\r\nimport { endpoints } from '@/lib/axios/axios-global';\r\nimport { useMemo, useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { SecondaryButton } from '@/components/buttons/SecondaryButton';\r\nimport CancelPopup from '@/components/Popups/CancelPopup';\r\nimport { AddBranchFormValues, AddBranchSchema } from '../schemas/add-branch-schema';\r\nimport BranchInfo from './BranchInfo';\r\nimport SuccessPopup from '@/components/Popups/SuccessPopup';\r\nimport { Branch } from '@/types/branches.types';\r\n\r\ninterface Props {\r\n    branch?: Branch | null;\r\n}\r\n\r\nexport default function AddBranchForm({ branch }: Props) {\r\n    const [error, setError] = useState<string | null>(null);\r\n    const [loading, setLoading] = useState(false);\r\n    const [showSuccessPopup, setShowSuccessPopup] = useState(false);\r\n    const [showCancelPopup, setShowCancelPopup] = useState(false);\r\n    const navigate = useNavigate();\r\n\r\n    const defaultValues = useMemo(\r\n        () => ({\r\n            name: branch?.name || '',\r\n            area: branch?.area || '',\r\n            city: branch?.city || '',\r\n            address: branch?.address || '',\r\n            phone: branch?.phone || '',\r\n            status: (branch?.status as 'active' | 'not active') || ('active' as 'active' | 'not active'),\r\n        }),\r\n        [branch],\r\n    );\r\n\r\n    const form = useForm<AddBranchFormValues>({\r\n        resolver: zodResolver(AddBranchSchema),\r\n        defaultValues,\r\n    });\r\n\r\n    const handleAddAnother = () => {\r\n        setShowSuccessPopup(false);\r\n    };\r\n\r\n    const onSubmit = async (data: AddBranchFormValues) => {\r\n        setLoading(true);\r\n        setError(null); // Clear previous errors\r\n        try {\r\n            await apiPost({\r\n                endpoint: branch ? endpoints.branch.update + branch.id : endpoints.branch.create,\r\n                body: data,\r\n                config: { headers: { 'Content-Type': 'multipart/form-data' } },\r\n            });\r\n            setShowSuccessPopup(true);\r\n        } catch (error: any) {\r\n            if (error.response?.data?.errors) {\r\n                // Handle field-specific errors\r\n                Object.entries(error.response.data.errors).forEach(([field, messages]) => {\r\n                    form.setError(field as any, {\r\n                        type: 'manual',\r\n                        message: (messages as string[]).join(', '),\r\n                    });\r\n                });\r\n            } else {\r\n                // Handle generic error\r\n                let errorMessage = 'حدث خطأ أثناء إرسال البيانات. يرجى المحاولة مرة أخرى.';\r\n                if (error.response) {\r\n                    errorMessage = error.response.data.msg || errorMessage;\r\n                } else if (error.request) {\r\n                    errorMessage = 'تعذر الاتصال بالخادم. يرجى التحقق من اتصالك بالإنترنت.';\r\n                }\r\n                setError(errorMessage);\r\n            }\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <Form {...form}>\r\n                <form onSubmit={form.handleSubmit(onSubmit)} className=\"mb-8\">\r\n                    <BranchInfo />\r\n                    {error && (\r\n                        <div className=\"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg\">\r\n                            <div className=\"flex justify-between items-center\">\r\n                                <span>{error}</span>\r\n                                <button onClick={() => setError(null)} className=\"text-red-700 hover:text-red-900\">\r\n                                    ×\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                    <div className=\"flex flex-row justify-between items-center mt-8\">\r\n                        {branch ? (\r\n                            <SecondaryButton\r\n                                type=\"button\"\r\n                                className=\"xl:px-[101px] xl:py-[18px] text-[#A21515] border border-red-error-50 xl:font-bold bg-red-error-50\"\r\n                                onClick={() => setShowCancelPopup(true)}\r\n                            >\r\n                                إلغاء الطلب\r\n                            </SecondaryButton>\r\n                        ) : (\r\n                            <SecondaryButton\r\n                                type=\"button\"\r\n                                className=\"xl:px-[64.5px] xl:py-[18px] border border-r-red-error-50 bg-red-error-50 text-[#A21515] xl:font-bold\"\r\n                                onClick={() => setShowCancelPopup(true)}\r\n                            >\r\n                                الغاء\r\n                            </SecondaryButton>\r\n                        )}\r\n                        <div>\r\n                            {branch ? (\r\n                                <PrimaryButton\r\n                                    className=\"xl:px-[107px] xl:py-[18px] xl:font-bold ms-6\"\r\n                                    disabled={loading}\r\n                                >\r\n                                    {loading ? 'جاري التحميل...' : 'حفظ التغييرات'}\r\n                                </PrimaryButton>\r\n                            ) : (\r\n                                <PrimaryButton\r\n                                    className=\"xl:px-[107px] xl:py-[18px] xl:font-bold ms-6\"\r\n                                    disabled={loading}\r\n                                >\r\n                                    {loading ? 'جاري التحميل...' : 'اضافة'}\r\n                                </PrimaryButton>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                </form>\r\n            </Form>\r\n\r\n            <CancelPopup\r\n                open={showCancelPopup}\r\n                onClickButton1={() => {\r\n                    setShowCancelPopup(false);\r\n                }}\r\n                onClickButton2={() => {\r\n                    navigate('/branches/list');\r\n                    setShowCancelPopup(false);\r\n                }}\r\n                text1={branch ? 'إلغاء تعديل بيانات فرع' : 'إلغاء طلب اضافة فرع'}\r\n                text2={\r\n                    branch\r\n                        ? 'أنت على وشك إلغاء عملية تعديل بيانات فرع دون إكمال البيانات المطلوبة. سيتم تجاهل جميع البيانات المدخلة، هل أنت متأكد؟'\r\n                        : 'أنت على وشك إلغاء عملية إضافة فرع دون إكمال البيانات المطلوبة. سيتم تجاهل جميع البيانات المدخلة، هل أنت متأكد؟'\r\n                }\r\n                textButton1=\"إكمال الطلب\"\r\n                textButton2=\"إلغاء الطلب\"\r\n            />\r\n\r\n            <SuccessPopup\r\n                text1={branch ? 'تم تعديل بيانات الفرع بنحاح' : 'تم إضافة فرع جديد بنحاح'}\r\n                text2={\r\n                    branch\r\n                        ? 'تم تعديل الفرع، يمكنك متابعة الفروع من قائمة الفروع.'\r\n                        : 'تم تسجيل فرع جديد، يمكنك متابعة الفروع من قائمة الفروع.'\r\n                }\r\n                textButton1=\"العودة لقائمة الفروع\"\r\n                textButton2={branch ? 'تعديل بيانات اخرى' : 'إضافة فرع أخر'}\r\n                open={showSuccessPopup}\r\n                onAddAnother={handleAddAnother}\r\n                onReturnToList={() => {\r\n                    navigate('/branches/list');\r\n                    setShowSuccessPopup(false);\r\n                }}\r\n            />\r\n        </>\r\n    );\r\n}\r\n"],"names":["Heading","jsxs","jsx","UnderlineHeading","MainHeading","AddBranchSchema","z","val","BranchInfo","TextInputForm","SelectInputForm","AddBranchForm","branch","error","setError","useState","loading","setLoading","showSuccessPopup","setShowSuccessPopup","showCancelPopup","setShowCancelPopup","navigate","useNavigate","defaultValues","useMemo","form","useForm","zodResolver","handleAddAnother","onSubmit","data","apiPost","endpoints","field","messages","errorMessage","Fragment","Form","SecondaryButton","PrimaryButton","CancelPopup","SuccessPopup"],"mappings":"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"}