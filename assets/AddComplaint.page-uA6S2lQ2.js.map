{"version":3,"file":"AddComplaint.page-uA6S2lQ2.js","sources":["../../src/features/selfServices/forms/addComplaint/ComplaintInfo.tsx","../../src/features/selfServices/forms/addComplaint/Submission.tsx","../../src/features/selfServices/forms/schemas/services/add-complaint-schema.ts","../../src/features/selfServices/forms/addComplaint/AddComplaintForm.tsx","../../src/features/selfServices/pages/AddComplaint.page.tsx"],"sourcesContent":["import SelectInputForm from '@/components/forms/SelectInputForm';\r\nimport TextInputForm from '@/components/forms/TextInputForm';\r\nimport { MaintenanceOrder } from '@/types/maintenance';\r\n\r\ninterface Props {\r\n    maintenanceOrder?: MaintenanceOrder | null;\r\n}\r\nexport default function ComplaintInfo({ maintenanceOrder }: Props) {\r\n    return (\r\n        <div className=\"my-6\">\r\n            <div className=\"grid grid-cols-1 gap-6\">\r\n                <TextInputForm name=\"title\" placeholder=\"بحث عن منتج، أو كتابة عنوان الشكوى\" label=\"موضوع الشكوى\" />\r\n                <SelectInputForm\r\n                    name=\"type\"\r\n                    placeholder=\"خيارات\"\r\n                    label=\"طريقة استقبال الشكوى\"\r\n                    options={[\r\n                        { name: 'البريد الإلكتروني', value: 'email' },\r\n                        { name: 'الهاتف', value: 'phone' },\r\n                        { name: 'الفاكس', value: 'fax' },\r\n                        { name: 'البريد العادي', value: 'mail' },\r\n                    ]}\r\n                    data={maintenanceOrder}\r\n                />\r\n                <SelectInputForm\r\n                    name=\"department\"\r\n                    placeholder=\"خيارات\"\r\n                    label=\"القسم المختص\"\r\n                    options={[\r\n                        { name: 'القسم الأول', value: '1' },\r\n                        { name: 'القسم الثاني', value: '2' },\r\n                        { name: 'القسم الثالث', value: '3' },\r\n                        { name: 'القسم الرابع', value: '4' },\r\n                    ]}\r\n                    data={maintenanceOrder}\r\n                />\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","import SuccessPopup from '@/components/Popups/SuccessPopup';\r\nimport { SecondaryButton } from '@/components/buttons/SecondaryButton';\r\nimport { PrimaryButton } from '@/components/buttons/PrimaryButton';\r\nimport CancelPopup from '@/components/Popups/CancelPopup';\r\nimport { MaintenanceOrder } from '@/types/maintenance';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\ninterface Props {\r\n    maintenanceOrder?: MaintenanceOrder | null;\r\n    showSuccessPopup: boolean;\r\n    setShowSuccessPopup: (value: boolean) => void;\r\n    showCancelPopup: boolean;\r\n    setShowCancelPopup: (value: boolean) => void;\r\n    loading: boolean;\r\n}\r\nexport default function Submission({\r\n    maintenanceOrder,\r\n    setShowCancelPopup,\r\n    setShowSuccessPopup,\r\n    showCancelPopup,\r\n    showSuccessPopup,\r\n    loading,\r\n}: Props) {\r\n    const navigate = useNavigate();\r\n\r\n    const handleAddAnother = () => {\r\n        setShowSuccessPopup(false);\r\n    };\r\n    return (\r\n        <>\r\n            <div className=\"flex flex-row justify-end items-center mt-8\">\r\n                {maintenanceOrder ? (\r\n                    <SecondaryButton\r\n                        type=\"button\"\r\n                        className=\"xl:px-[87px] xl:py-3 text-[#A21515] border border-red-error-50 xl:font-semibold bg-red-error-50\"\r\n                        onClick={() => setShowCancelPopup(true)}\r\n                    >\r\n                        إلغاء الشكوى\r\n                    </SecondaryButton>\r\n                ) : (\r\n                    <SecondaryButton\r\n                        type=\"button\"\r\n                        className=\"xl:px-[87px] xl:py-3 border bordr-[#E8EFF6] xl:font-semibold\"\r\n                        onClick={() => setShowCancelPopup(true)}\r\n                    >\r\n                        الغاء\r\n                    </SecondaryButton>\r\n                )}\r\n                <div>\r\n                    {maintenanceOrder ? (\r\n                        <PrimaryButton className=\"xl:px-[91px] xl:py-3 xl:font-semibold ms-6\" disabled={loading}>\r\n                            {loading ? 'جاري التحميل...' : 'حفظ التغييرات'}\r\n                        </PrimaryButton>\r\n                    ) : (\r\n                        <PrimaryButton className=\"xl:px-[91px] xl:py-3 xl:font-semibold ms-6\" disabled={loading}>\r\n                            {loading ? 'جاري التحميل...' : 'تسجيل الشكوى'}\r\n                        </PrimaryButton>\r\n                    )}\r\n                </div>\r\n            </div>\r\n            <CancelPopup\r\n                open={showCancelPopup}\r\n                onClickButton1={() => {\r\n                    setShowCancelPopup(false);\r\n                }}\r\n                onClickButton2={() => {\r\n                    navigate('/self-services/services');\r\n                    setShowCancelPopup(false);\r\n                }}\r\n                text1={maintenanceOrder ? 'إلغاء تعديل بيانات تسجيل الشكوى' : 'إلغاء تسجيل الشكوى'}\r\n                text2={\r\n                    maintenanceOrder\r\n                        ? 'أنت على وشك إلغاء عملية تعديل بيانات الشكوى دون إكمال البيانات المطلوبة. سيتم تجاهل جميع البيانات المدخلة، هل أنت متأكد؟'\r\n                        : 'أنت على وشك إلغاء عملية إضافة الشكوى دون إكمال البيانات المطلوبة. سيتم تجاهل جميع البيانات المدخلة، هل أنت متأكد؟'\r\n                }\r\n                textButton1=\"إكمال الشكوى\"\r\n                textButton2=\"إلغاء الشكوى\"\r\n            />\r\n            <SuccessPopup\r\n                text1={maintenanceOrder ? 'تم تعديل بيانات الشكوى بنحاح' : 'تم إضافة الشكوى بنحاح'}\r\n                text2={\r\n                    maintenanceOrder\r\n                        ? 'تم تعديل بيانات الشكوى المطلوبة، يمكنك المتابعه مع مركز الشكاوى\".'\r\n                        : 'تم تعديل بيانات الشكوى المطلوبة، يمكنك المتابعه مع مركز الشكاوى\".'\r\n                }\r\n                textButton1=\"العودة لقائمة الشكاوى\"\r\n                textButton2={maintenanceOrder ? 'تعديل بيانات اخرى' : 'إضافة شكوى اخرى'}\r\n                open={showSuccessPopup}\r\n                onAddAnother={handleAddAnother}\r\n                onReturnToList={() => {\r\n                    navigate('/self-services/services?complaints=true');\r\n                    setShowSuccessPopup(false);\r\n                }}\r\n            />\r\n        </>\r\n    );\r\n}\r\n","import { z } from 'zod';\r\n\r\nexport const AddComplaintSchema = z.object({\r\n    title: z.string().min(1, 'Address is required'),\r\n    type: z.string().min(1, 'The complaint reception type field is required.'),\r\n    department: z.string().min(1, 'Department is required'),\r\n    description: z.string().min(1, 'Description is required'),\r\n});\r\n\r\nexport type AddComplaintFormValues = z.infer<typeof AddComplaintSchema>;\r\n","import { Form } from '@/components/ui/form';\r\nimport { useForm } from 'react-hook-form';\r\nimport { zodResolver } from '@hookform/resolvers/zod';\r\nimport { apiPost } from '@/lib/axios/axios-utils';\r\nimport { endpoints } from '@/lib/axios/axios-global';\r\nimport { useMemo, useState } from 'react';\r\nimport { RichTextEditor } from '@/components/forms/textEditor/RichTextInput';\r\nimport { MaintenanceOrder } from '@/types/maintenance';\r\nimport ComplaintInfo from './ComplaintInfo';\r\nimport Submission from './Submission';\r\nimport { AddComplaintFormValues, AddComplaintSchema } from '../schemas/services/add-complaint-schema';\r\n\r\ninterface Props {\r\n    maintenanceOrder?: MaintenanceOrder | null;\r\n}\r\n\r\nexport default function AddComplaintForm({ maintenanceOrder }: Props) {\r\n    const [error, setError] = useState<string | null>(null);\r\n    const [loading, setLoading] = useState(false);\r\n    const [showSuccessPopup, setShowSuccessPopup] = useState(false);\r\n    const [showCancelPopup, setShowCancelPopup] = useState(false);\r\n\r\n    const defaultValues = useMemo(\r\n        () => ({\r\n            title: maintenanceOrder?.cost ? String(maintenanceOrder?.cost) : undefined,\r\n            type: maintenanceOrder?.description || '',\r\n            department: maintenanceOrder?.description || '',\r\n            description: maintenanceOrder?.description || '',\r\n        }),\r\n        [maintenanceOrder],\r\n    );\r\n\r\n    const form = useForm<AddComplaintFormValues>({\r\n        resolver: zodResolver(AddComplaintSchema),\r\n        defaultValues,\r\n    });\r\n\r\n    const onSubmit = async (data: AddComplaintFormValues) => {\r\n        setLoading(true);\r\n        setError(null); // Clear previous errors\r\n        try {\r\n            await apiPost({\r\n                endpoint: maintenanceOrder\r\n                    ? endpoints.employeeComplaint.update + maintenanceOrder.id\r\n                    : endpoints.employeeComplaint.create,\r\n                body: data,\r\n                // config: { headers: { 'Content-Type': 'multipart/form-data' } },\r\n            });\r\n            setShowSuccessPopup(true);\r\n        } catch (error: any) {\r\n            if (error.response?.data?.errors) {\r\n                // Handle field-specific errors\r\n                Object.entries(error.response.data.errors).forEach(([field, messages]) => {\r\n                    form.setError(field as any, {\r\n                        type: 'manual',\r\n                        message: (messages as string[]).join(', '),\r\n                    });\r\n                });\r\n            } else {\r\n                // Handle generic error\r\n                let errorMessage = 'حدث خطأ أثناء إرسال البيانات. يرجى المحاولة مرة أخرى.';\r\n                if (error.response) {\r\n                    errorMessage = error.response.data.msg || errorMessage;\r\n                } else if (error.request) {\r\n                    errorMessage = 'تعذر الاتصال بالخادم. يرجى التحقق من اتصالك بالإنترنت.';\r\n                }\r\n                setError(errorMessage);\r\n            }\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <Form {...form}>\r\n                <form onSubmit={form.handleSubmit(onSubmit)} className=\"mb-8\">\r\n                    {error && (\r\n                        <div className=\"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg\">\r\n                            <div className=\"flex justify-between items-center\">\r\n                                <span className=\"\">{error}</span>\r\n                                <button onClick={() => setError(null)} className=\"text-red-700 hover:text-red-900\">\r\n                                    ×\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                    <ComplaintInfo maintenanceOrder={maintenanceOrder} />\r\n                    <div>\r\n                        <p className=\"text-primery-blue-900 font-medium text-[18px] leading-[33.73px] tracking-normal text-start mb-4\">\r\n                            نص الشكوى\r\n                        </p>\r\n                        <RichTextEditor\r\n                            form={form}\r\n                            data={maintenanceOrder?.description}\r\n                            name=\"description\"\r\n                            placeholder=\"ادخل وصف المنتج\"\r\n                        />\r\n                    </div>\r\n                    <Submission\r\n                        maintenanceOrder={maintenanceOrder}\r\n                        loading={loading}\r\n                        setShowCancelPopup={setShowCancelPopup}\r\n                        setShowSuccessPopup={setShowSuccessPopup}\r\n                        showCancelPopup={showCancelPopup}\r\n                        showSuccessPopup={showSuccessPopup}\r\n                    />\r\n                </form>\r\n            </Form>\r\n        </>\r\n    );\r\n}\r\n","import AddBulkIcon from '@/components/icons/BulkAddIcon';\r\nimport SyncIcon from '@/components/icons/SyncIcon';\r\nimport AddComplaintForm from '../forms/addComplaint/AddComplaintForm';\r\n\r\nexport default function AddComplaintPage() {\r\n    return (\r\n        <div className=\"w-full mt-6 p-4\">\r\n            <div className=\"flex flex-row items-center justify-between\">\r\n                <h1 className=\"font-bold text-[#080614] text-[24px] tracking-normal flex flex-row items-center gap-2\">\r\n                    <AddBulkIcon />\r\n                    إضافة شكوى\r\n                </h1>\r\n                <div className=\"px-4 py-3 bg-[#F5F4F5] border border-[#E1DEE0] rounded-lg flex flex-row items-center justify-between gap-2\">\r\n                    <p className=\"font-bold text-[#423E41] text-base tracking-normal\">رقم الشكوى:</p>\r\n                    <p className=\"font-medium text-[#9E939A] text-base tracking-normal me-[2px]\">#2324510</p>\r\n                    <SyncIcon />\r\n                </div>\r\n            </div>\r\n            <AddComplaintForm />\r\n        </div>\r\n    );\r\n}\r\n"],"names":["ComplaintInfo","maintenanceOrder","jsxs","jsx","TextInputForm","SelectInputForm","Submission","setShowCancelPopup","setShowSuccessPopup","showCancelPopup","showSuccessPopup","loading","navigate","useNavigate","handleAddAnother","Fragment","SecondaryButton","PrimaryButton","CancelPopup","SuccessPopup","AddComplaintSchema","z","AddComplaintForm","error","setError","useState","setLoading","defaultValues","useMemo","form","useForm","zodResolver","onSubmit","data","apiPost","endpoints","field","messages","errorMessage","Form","RichTextEditor","AddComplaintPage","AddBulkIcon","SyncIcon"],"mappings":"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"}