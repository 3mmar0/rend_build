import{d as H,j as e,r as g,e as L}from"./index-BYyXun5x.js";import{S as k}from"./SubtleButton-CpZm4xzO.js";import{U as O}from"./UnderlineHeading-ByjNC2ge.js";import{S as D}from"./SyncIcon-Bc7rrv6_.js";import{M as S}from"./MainHeading-DYhLcFx9.js";import{f as I,a as q,b as E,d as M,e as A,c as G,z as t,u as Z,t as z,F as W}from"./index-C2_QJ2lf.js";import{b as Y,a as $}from"./axios-utils-AvuZ81CO.js";import{S as X}from"./SuccessPopup-D1XZ3Spp.js";import{S as T}from"./SecondaryButton-DL_Bkgwn.js";import{P as R}from"./PrimaryButton-CZnRZgcz.js";import{C as J}from"./CancelPopup-DUQLiKLA.js";import{S as K}from"./SearchableSelectInputForm-v1_SI72T.js";import{S as w}from"./SelectInputForm-CG_Opxs4.js";import{T as Q}from"./TextAreaInputForm-BzEUWSiD.js";import{T as v}from"./TextInputForm-DXNY8AYK.js";import{D as F}from"./DateInputForm-D1c84cxT.js";import{R as ee,a as V}from"./radio-group-DV1HhCjd.js";import{u as re}from"./index-BUOh6qUH.js";import{r as se}from"./removeDuplicated-BgoSiW5F.js";import{f}from"./format-D6Kkl3rb.js";import"./index-CV4wEvKw.js";import"./SuccessIcon-BhPCSHz0.js";import"./dialog-CC_6CGm6.js";import"./Combination-cklTRtAe.js";import"./index-CLYNl1a9.js";import"./select-779NlImg.js";import"./index-Gk0NKYh3.js";import"./textarea-CQid9q9Y.js";import"./popover-BWwxYxvp.js";import"./chevron-right-CymCusjh.js";import"./chevron-left-DVnc3BG0.js";import"./CalendarIcon-ChMYIy2j.js";import"./index-DEdjAgo6.js";import"./index-Cod7pasn.js";function te({employee:r,setShowCancelPopup:s,setShowSuccessPopup:i,showCancelPopup:p,showSuccessPopup:m,loading:a}){const c=H(),n=()=>{i(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-row justify-end items-center mt-8",children:[r?e.jsx(T,{type:"button",className:"xl:px-[87px] xl:py-3 text-[#A21515] border border-red-error-50 xl:font-semibold bg-red-error-50",onClick:()=>s(!0),children:"إلغاء الشكوى"}):e.jsx(T,{type:"button",className:"xl:px-[87px] bg-red-error-50 text-[#A21515] hover:bg-red-error-600 hover:text-white-blue-50 xl:py-3 border bordr-[#E8EFF6] xl:font-semibold",onClick:()=>s(!0),children:"الغاء"}),e.jsx("div",{children:r?e.jsx(R,{className:"xl:px-[91px] xl:py-3 xl:font-semibold ms-6",disabled:a,children:a?"جاري التحميل...":"حفظ التغييرات"}):e.jsx(R,{className:"xl:px-[91px] xl:py-3 xl:font-semibold ms-6",disabled:a,children:a?"جاري التحميل...":"حفظ"})})]}),e.jsx(J,{open:p,onClickButton1:()=>{s(!1)},onClickButton2:()=>{c("/human-resources"),s(!1)},text1:r?"إلغاء تعديل بيانات الموظف":"إلغاء إضافة عقد",text2:r?"أنت على وشك إلغاء عملية تعديل بيانات العقد دون إكمال البيانات المطلوبة. سيتم تجاهل جميع البيانات المدخلة، هل أنت متأكد؟":"أنت على وشك إلغاء عملية إضافة عقد جديد دون إكمال البيانات المطلوبة. سيتم تجاهل جميع البيانات المدخلة، هل أنت متأكد؟",textButton1:r?"إكمال التعديل":"إكمال الإضافة",textButton2:r?"إلغاء التعديل":"إلغاء الإضافة"}),e.jsx(X,{text1:r?"تم تعديل بيانات العقد بنحاح":"تم إضافة عقد جديد بنحاح",text2:r?"تم تعديل بيانات العقد بنحاح":"تم تسجيل بيانات العقد الجديد بنجاح.",textButton1:"العودة لقائمة العقود",textButton2:r?"تعديل بيانات اخرى":"إضافة عقد أخر",open:m,onAddAnother:n,onReturnToList:()=>{c("/human-resources/contract-management"),i(!1)}})]})}function ae(){const[r,s]=g.useState([]),[i,p]=g.useState(null);return g.useEffect(()=>{(async()=>{try{const c=(await Y({endpoint:L.employee.list})).data.data.data.map(n=>({name:n.name,value:String(n.id)}));s(c),p(null)}catch{p("Error fetching employees. Please try again later.")}})()},[]),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(K,{name:"employee_id",placeholder:"ادخل اسم الموظف",label:"اسم العميل",options:r,error:i,data:!0}),e.jsx(v,{name:"employee_number",label:"كود",placeholder:"#899657"}),e.jsx(v,{name:"position",label:"رقم المسمى الوظيفي",placeholder:"ادخل المسمى الوظيفي"}),e.jsx(v,{name:"employee_degree",label:"المستوى الوظيفي",placeholder:"ادخل المستوى الوظيفي"}),e.jsx(w,{name:"main_contract",label:"العقد الاساسي",options:[{value:"high_school",name:"الثانوية العامة"},{value:"bachelor",name:"بكالوريوس"},{value:"master",name:"ماجستير"},{value:"phd",name:"دكتوراه"}],placeholder:"اختر القسم"}),e.jsx(w,{name:"contract_type",label:"نوع العمل ",options:[{value:"high_school",name:"الثانوية العامة"},{value:"bachelor",name:"بكالوريوس"},{value:"master",name:"ماجستير"},{value:"phd",name:"دكتوراه"}],placeholder:"اختر  القسم"})]}),e.jsx("div",{className:"w-full mt-6",children:e.jsx(Q,{className:"flex flex-col min-h-[157px]",name:"description",label:"الوصف",placeholder:"ادخل المستوى الوظيفي"})})]})}const ne=({name:r,date1Name:s,date2Name:i,label1:p,label2:m})=>{const{control:a}=I(),{watch:c}=I(),n=c(r),j=new Date().getFullYear(),b=Array.from({length:10},(x,h)=>j-h).map(x=>({name:x.toString(),value:x.toString()}));return e.jsx(q,{control:a,name:r,render:({field:x})=>e.jsxs(E,{className:"space-y-4",children:[e.jsx(M,{children:e.jsxs(ee,{onValueChange:x.onChange,value:x.value,className:"space-y-4 grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2 border p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 space-x-2",children:[e.jsx(V,{value:"annual",id:"option1"}),e.jsx("label",{htmlFor:"option1",children:p})]}),e.jsx(q,{control:a,name:s,render:({field:h})=>e.jsxs(E,{children:[e.jsx(M,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(w,{className:"",name:"end_month",label:"شهر",disabled:n!=="annual",options:[{value:"january",name:"يناير"},{value:"february",name:"فبراير"},{value:"march",name:"مارس"},{value:"april",name:"أبريل"},{value:"may",name:"مايو"},{value:"june",name:"يونيو"},{value:"july",name:"يوليو"},{value:"august",name:"أغسطس"},{value:"september",name:"سبتمبر"},{value:"october",name:"أكتوبر"},{value:"november",name:"نوفمبر"},{value:"december",name:"ديسمبر"}],placeholder:"اختر الشهر"}),e.jsx(w,{name:"end_year",label:"سنة",disabled:n!=="annual",options:[...b],placeholder:"اختر الشهر"})]})}),e.jsx(A,{})]})})]}),e.jsxs("div",{className:"space-y-2 border p-4 rounded-lg !mt-0",children:[e.jsxs("div",{className:"flex items-center gap-3 space-x-2",children:[e.jsx(V,{value:"end_date",id:"option2"}),e.jsx("label",{htmlFor:"option2",children:m})]}),e.jsx(q,{control:a,name:i,render:({field:h})=>e.jsxs(E,{children:[e.jsx(M,{children:e.jsx(F,{name:"end_date",label:"تاريخ الانتهاء",disabledDate:n!=="end_date",placeholder:"2025/05/20"})}),e.jsx(A,{})]})})]})]})}),e.jsx(A,{})]})})};function ie(){return e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(F,{name:"start_date",label:"تاريخ البدء",placeholder:"2025/05/20"}),e.jsx(F,{name:"sign_date",label:"تاريخ التوقيع",placeholder:"2025/05/20"}),e.jsx(F,{name:"join_date",label:"تاريخ الالتحاق",placeholder:"2025/05/20"}),e.jsx(F,{name:"test_end_date",label:"تاريخ نهاية الاختبار",placeholder:"2025/05/20"})]}),e.jsxs("div",{className:"my-4",children:[e.jsx("p",{className:"text-primery-blue-900 mb-2 font-medium text-[18px] leading-[33.73px] tracking-normal text-start",children:"نوع صلاحية العقد"}),e.jsx(ne,{name:"contract_end_date_type",date1Name:"date1",date2Name:"date2",label1:"مدة سنوية",label2:"تاريخ الانتهاء"})]})]})}function oe(){return e.jsxs("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(v,{name:"housing_allowance",label:"بدل السكن",placeholder:"4000 ر.س"}),e.jsx(v,{name:"transportation_allowance",label:"بدل المواصلات",placeholder:"80 ر.س"})]})}function le(){return e.jsxs("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(w,{name:"currency",label:"العملة",options:[{value:"high_school",name:"الثانوية العامة"},{value:"bachelor",name:"بكالوريوس"},{value:"master",name:"ماجستير"},{value:"phd",name:"دكتوراه"}],placeholder:"ريال سعودي"}),e.jsx(w,{name:"salary_cycle",label:"دورة القبض ",options:[{value:"high_school",name:"الثانوية العامة"},{value:"bachelor",name:"بكالوريوس"},{value:"master",name:"ماجستير"},{value:"phd",name:"دكتوراه"}],placeholder:"شهري -  أسبوعي  - ربع سنوي - يومي"}),e.jsx(v,{name:"salary",label:"الراتب",placeholder:"4000 ر.س"}),e.jsx(v,{name:"overtime_rate",label:"الساعه الاضافية",placeholder:"80 ر.س"})]})}const de=({className:r,name:s,label:i,maxSize:p,multiple:m,editImages:a})=>{const{control:c,setValue:n,watch:j,getValues:b}=I(),[x,h]=g.useState([]),o=l=>{const d=b(s),u=Array.isArray(d)?d.filter((N,C)=>C!==l):[];n(s,u,{shouldValidate:!0}),h(N=>N.filter((B,y)=>(y===l&&URL.revokeObjectURL(N[y]),y!==l)))},P=(l,d)=>{if(m&&a){const u=b(d),C=[...Array.isArray(u)?u:[],...l];n(d,se(C),{shouldValidate:!0});const B=l.map(y=>URL.createObjectURL(y));h(y=>[...y,...B])}else n(d,m?l:l[0],{shouldValidate:!0}),h(l.map(u=>URL.createObjectURL(u)))},_=j(s);return g.useEffect(()=>{(!_||_.length===0)&&h([])},[_]),g.useEffect(()=>{a&&(n(s,a,{shouldValidate:!0}),h(Array.isArray(a)?a:[a]))},[]),e.jsx(q,{control:c,name:s,render:({field:l})=>e.jsxs(E,{className:r,children:[e.jsx(G,{className:"text-primery-blue-900 font-medium text-[18px] leading-[33.73px] tracking-normal text-start",children:i}),e.jsx(M,{children:e.jsx(me,{onDrop:d=>P(d,s),acceptedFiles:l.value,previews:x,maxSize:p,multiple:m,removeImage:o})}),e.jsx(A,{})]})})};function me({onDrop:r,previews:s,maxSize:i,multiple:p,removeImage:m}){const{getRootProps:a,getInputProps:c}=re({onDrop:r,accept:{"application/pdf":[],"image/*":[]},multiple:p,maxSize:i});return e.jsxs("div",{...a(),className:"border-2 border-dashed border-primery-blue-500 rounded-lg p-4 text-center cursor-pointer",children:[e.jsx("input",{...c()}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-row items-center justify-between text-base leading-5 tracking-normal font-medium",children:[e.jsxs("div",{className:"flex flex-row items-center gap-2 mb-5",children:[e.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M10.7521 23.4006C10.366 25.0819 8.41456 26.783 6.31738 25.3982C6.31738 25.3982 7.67526 26.605 10.4333 26.605H22.4646C23.9666 26.605 25.2654 25.5577 25.5843 24.0894L27.0886 16.6907C27.5357 14.373 26.0064 13.2734 23.9703 13.2734H15.5231C14.0248 13.2734 12.7272 14.3158 12.4059 15.7791L10.7521 23.4006Z",stroke:"#145DA0",strokeWidth:"1.44",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M10.4339 26.6056C6.46498 26.6056 4.12744 24.2731 4.12744 20.314V11.685C4.12744 7.73098 5.58202 5.39844 9.54101 5.39844H11.754C12.5485 5.39844 13.2958 5.77329 13.7715 6.40842L14.7815 7.75215C15.2597 8.38605 16.0081 8.75965 16.8026 8.76214H18.6707C22.0917 8.76214 23.6522 10.2628 24.017 13.2641",stroke:"#145DA0",strokeWidth:"1.44",strokeLinecap:"round",strokeLinejoin:"round"})]}),e.jsx("p",{className:"font-medium text-sm text-[#2D2D3A]",children:"قم برفع ملف أو قم سحبه هنا"})]}),e.jsx(T,{type:"button",className:"h-[30px]",children:"اختيار الملف"})]}),e.jsx("div",{className:"flex flex-row justify-center gap-2 border-2 border-dashed border-primery-blue-500 rounded-lg p-8",children:s==null?void 0:s.map((n,j)=>e.jsxs("div",{className:"relative group flex flex-col items-center text-sm text-muted-foreground",children:[e.jsx("img",{src:n,alt:`Preview ${j+1}`,className:"w-20 h-20 object-cover rounded-md"}),e.jsx("button",{type:"button",onClick:b=>{b.stopPropagation(),m(j)},className:"absolute w-6 h-6 top-1 start-1 bg-red-error-600 text-white-blue-50 p-1 rounded-full text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:"✕"})]},j))}),e.jsx("div",{children:e.jsxs("ul",{className:"text-xs leading-[22.5px] font-medium tracking-normal text-start text-[#90868C] list-[square] marker:text-[8px] ps-5 mt-2",children:[e.jsxs("li",{children:["اقصى حجم ",e.jsxs("span",{className:"font-bold ms-[2px]",children:[i/1024/1024,"MB"]})]}),e.jsxs("li",{children:["الملفات المسموح بها",e.jsx("span",{className:"font-bold ms-[2px]",children:"jpeg , png , jpg, gif, svg"})]})]})})]})]})}const U=10*1024*1024,ce=["image/jpeg","image/png","image/jpg","image/gif","image/svg+xml"],ue=t.object({employee_id:t.string().min(1,"Name is required"),employee_number:t.string().min(1,"Address is required"),position:t.string().min(1,"The personal id number field is required."),employee_degree:t.string().min(1,"The personal id number field is required."),main_contract:t.string().min(1,"The personal id number field is required."),contract_type:t.string().min(1,"The personal id number field is required."),description:t.string().min(1,"The personal id number field is required."),start_date:t.date({required_error:"This field is required"}),sign_date:t.date({required_error:"This field is required"}),test_end_date:t.date({required_error:"This field is required"}),contract_end_date_type:t.string().min(1,"This field is required"),join_date:t.date({required_error:"This field is required"}),end_date:t.date({required_error:"End date is required if month and year are not provided"}).optional(),end_month:t.string().optional(),end_year:t.string().optional(),currency:t.string().min(1,"Department is required"),salary_cycle:t.string().min(1,"Position name is required"),salary:t.string().min(1,"Position name is required"),overtime_rate:t.string().min(1,"Position name is required"),housing_allowance:t.string().min(1,"Position name is required"),transportation_allowance:t.string().min(1,"Position name is required"),file:t.instanceof(File,{message:"Image is required"}).refine(r=>r.size<=U,`Image must be less than ${U}MB`).refine(r=>ce.includes(r.type),"Only .jpeg, .png, .jpg, .gif, and .svg formats are allowed")}).superRefine((r,s)=>{r.end_date===void 0&&((!r.end_month||r.end_month.trim()==="")&&s.addIssue({code:t.ZodIssueCode.custom,message:"End month is required when end date is not provided",path:["end_month"]}),(!r.end_year||r.end_year.trim()==="")&&s.addIssue({code:t.ZodIssueCode.custom,message:"End year is required when end date is not provided",path:["end_year"]}))});function pe({employee:r}){const[s,i]=g.useState(null),[p,m]=g.useState(!1),[a,c]=g.useState(!1),[n,j]=g.useState(!1),b=g.useMemo(()=>({}),[r]),x=Z({resolver:z(ue),defaultValues:b}),h=async o=>{var _,l;m(!0),i(null);const P=o.end_date?{...o,start_date:f(o.start_date,"yyyy-MM-dd"),sign_date:f(o.sign_date,"yyyy-MM-dd"),test_end_date:f(o.test_end_date,"yyyy-MM-dd"),end_date:f(o.end_date,"yyyy-MM-dd"),join_date:f(o.join_date,"yyyy-MM-dd")}:{...o,start_date:f(o.start_date,"yyyy-MM-dd"),sign_date:f(o.sign_date,"yyyy-MM-dd"),test_end_date:f(o.test_end_date,"yyyy-MM-dd"),join_date:f(o.join_date,"yyyy-MM-dd")};try{await $({endpoint:r?L.hrContract.update+r.id:L.hrContract.create,body:P,config:{headers:{"Content-Type":"multipart/form-data"}}}),c(!0)}catch(d){if((l=(_=d.response)==null?void 0:_.data)!=null&&l.errors)Object.entries(d.response.data.errors).forEach(([u,N])=>{x.setError(u,{type:"manual",message:N.join(", ")})});else{let u="حدث خطأ أثناء إرسال البيانات. يرجى المحاولة مرة أخرى.";d.response?u=d.response.data.msg||u:d.request&&(u="تعذر الاتصال بالخادم. يرجى التحقق من اتصالك بالإنترنت."),i(u)}}finally{m(!1)}};return e.jsx(e.Fragment,{children:e.jsx(W,{...x,children:e.jsxs("form",{onSubmit:x.handleSubmit(h),className:"mb-8",children:[s&&e.jsx("div",{className:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"",children:s}),e.jsx("button",{onClick:()=>i(null),className:"text-red-700 hover:text-red-900",children:"×"})]})}),e.jsxs("div",{children:[e.jsx(S,{text:"معلومات العقد"}),e.jsx(ae,{}),e.jsx(S,{text:"تفاصيل المدة"}),e.jsx(ie,{}),e.jsx(S,{text:"تفاصيل المرتب"}),e.jsx(le,{}),e.jsx(S,{text:"تفاصيل البدلات"}),e.jsx(oe,{})]}),e.jsx("div",{className:"mt-6",children:e.jsx(de,{name:"file",label:"رفع ملف",multiple:!1,maxSize:10*1024*1024})}),e.jsx(te,{employee:r,loading:p,setShowCancelPopup:j,setShowSuccessPopup:c,showCancelPopup:n,showSuccessPopup:a})]})})})}function Ye(){return e.jsxs("div",{className:"w-full mt-6",children:[e.jsxs("div",{className:"flex flex-row justify-between mb-6",children:[e.jsx(O,{className:"h-fit",text:"تحديث العقد"}),e.jsxs("div",{className:"flex flex-row gap-5",children:[e.jsxs(k,{className:"bg-[#FFF8E8] text-base font-medium leading-[125%] text-[#FBB90D] border border-[#FFF8E8] hover:hover:bg-[#FDECCB]",children:[e.jsx(D,{width:"20",height:"20"}),"تعليق العقد"]}),e.jsxs(k,{className:"bg-red-error-50 text-base font-medium leading-[125%] text-[#A21515] hover:bg-[#A21515] hover:text-white-blue-50 border border-red-error-50",children:[e.jsx(D,{width:"20",height:"20"}),"حذف العقد"]}),e.jsxs(k,{className:"bg-primery-blue-50 text-base font-medium leading-[125%] text-primery-blue-500 border border-primery-blue-50",children:[e.jsx(D,{width:"20",height:"20",className:"text-primery-blue-500"}),"تجديد العقد"]})]})]}),e.jsx(pe,{})]})}export{Ye as default};
//# sourceMappingURL=AddContract.page-C8yI5awV.js.map
