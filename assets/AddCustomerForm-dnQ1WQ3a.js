import{j as i,r as d,d as N,e as y}from"./index-BYyXun5x.js";import{z as s,u as C,t as M,F as z}from"./index-C2_QJ2lf.js";import{P as S}from"./PrimaryButton-CZnRZgcz.js";import{a as T}from"./axios-utils-AvuZ81CO.js";import{S as I}from"./SecondaryButton-DL_Bkgwn.js";import{C as $}from"./CancelPopup-DUQLiKLA.js";import{M as F}from"./MainHeading-DYhLcFx9.js";import{S as O}from"./SuccessPopup-D1XZ3Spp.js";import{T as l}from"./TextInputForm-DXNY8AYK.js";import{I as g}from"./ImgInputForm-DDkW58ya.js";function D(){return i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-3 gap-6",children:[i.jsx(l,{name:"full_name",label:"اسم العميل",placeholder:"ادخل اسم العميل"}),i.jsx(l,{label:"رقم الهاتف",placeholder:"ادخل رقم الهاتف",className:"[&>input]:text-end [&>input]:placeholder:text-end",name:"phone",type:"tel"}),i.jsx(l,{name:"email",label:"الإيميل",placeholder:"ادخل الإيميل"})]}),i.jsxs("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-3 gap-6",children:[i.jsx(l,{name:"address",label:"العنوان",placeholder:"ادخل العنوان"}),i.jsx(l,{name:"personal_id_number",label:"رقم البطاقة الشخصية",placeholder:"ادخل رقم البطاقة الشخصية"}),i.jsx(l,{name:"driver_license_number",label:"رقم رخصة القيادة",placeholder:"ادخل رقم الرخصة"})]})]})}const n=10*1024*1024,p=["image/jpeg","image/png","image/jpg","image/gif","image/svg+xml"],L=s.object({full_name:s.string().min(1,"The full name field is required."),phone:s.string().min(1,"رقم الهاتف مطلوب").refine(e=>/^\d+$/.test(e),"الرجاء إدخال أرقام فقط").refine(e=>e.length>=8&&e.length<=15,"يجب أن يتكون رقم الهاتف من 8 إلى 15 رقم"),email:s.string().min(1,"The email field is required.").email("Please enter a valid email address."),address:s.string().min(1,"Address is required"),personal_id_number:s.string().min(1,"The personal id number field is required."),driver_license_number:s.string().min(1,"The driver license number field is required."),personal_id_img_front:s.instanceof(File,{message:"Personal ID front image is required."}).refine(e=>e.size<=n,`Image must be less than ${n}MB`).refine(e=>p.includes(e.type),"Only .jpeg, .png, .jpg, .gif, and .svg formats are allowed"),personal_id_img_back:s.instanceof(File,{message:"Personal ID back image is required."}).refine(e=>e.size<=n,`Image must be less than ${n}MB`).refine(e=>p.includes(e.type),"Only .jpeg, .png, .jpg, .gif, and .svg formats are allowed"),driver_license_img_front:s.instanceof(File,{message:"Driver license front image is required."}).refine(e=>e.size<=n,`Image must be less than ${n}MB`).refine(e=>p.includes(e.type),"Only .jpeg, .png, .jpg, .gif, and .svg formats are allowed"),driver_license_img_back:s.instanceof(File,{message:"Driver license back image is required."}).refine(e=>e.size<=n,`Image must be less than ${n}MB`).refine(e=>p.includes(e.type),"Only .jpeg, .png, .jpg, .gif, and .svg formats are allowed")}),r=10*1024*1024,f=["image/jpeg","image/png","image/jpg","image/gif","image/svg+xml"],R=s.object({full_name:s.string().min(1,"The full name field is required."),phone:s.string().min(1,"رقم الهاتف مطلوب").refine(e=>/^\d+$/.test(e),"الرجاء إدخال أرقام فقط").refine(e=>e.length>=8&&e.length<=15,"يجب أن يتكون رقم الهاتف من 8 إلى 15 رقم"),address:s.string().min(1,"Address is required"),personal_id_number:s.string().min(1,"The personal id number field is required."),driver_license_number:s.string().min(1,"The driver license number field is required."),personal_id_img_front:s.instanceof(File,{message:"Personal ID front image is required."}).refine(e=>e.size<=r,`Image must be less than ${r}MB`).refine(e=>f.includes(e.type),"Only .jpeg, .png, .jpg, .gif, and .svg formats are allowed").optional(),personal_id_img_back:s.instanceof(File,{message:"Personal ID back image is required."}).refine(e=>e.size<=r,`Image must be less than ${r}MB`).refine(e=>f.includes(e.type),"Only .jpeg, .png, .jpg, .gif, and .svg formats are allowed").optional(),driver_license_img_front:s.instanceof(File,{message:"Driver license front image is required."}).refine(e=>e.size<=r,`Image must be less than ${r}MB`).refine(e=>f.includes(e.type),"Only .jpeg, .png, .jpg, .gif, and .svg formats are allowed").optional(),driver_license_img_back:s.instanceof(File,{message:"Driver license back image is required."}).refine(e=>e.size<=r,`Image must be less than ${r}MB`).refine(e=>f.includes(e.type),"Only .jpeg, .png, .jpg, .gif, and .svg formats are allowed").optional()});function U({customer:e}){const[b,c]=d.useState(null),[o,_]=d.useState(!1),[q,x]=d.useState(!1),[w,m]=d.useState(!1),h=N(),B=d.useMemo(()=>({full_name:(e==null?void 0:e.full_name)||"",phone:(e==null?void 0:e.phone)||"",email:(e==null?void 0:e.email)||"",address:(e==null?void 0:e.address)||"",personal_id_number:(e==null?void 0:e.personal_id_number)||"",driver_license_number:(e==null?void 0:e.driver_license_number)||""}),[e]),u=C({resolver:M(e?R:L),defaultValues:B}),E=()=>{x(!1)},P=async k=>{var j,v;_(!0),c(null);try{await T({endpoint:e?y.customer.update+e.id:y.customer.create,body:k,config:{headers:{"Content-Type":"multipart/form-data"}}}),x(!0)}catch(t){if((v=(j=t.response)==null?void 0:j.data)!=null&&v.errors)Object.entries(t.response.data.errors).forEach(([a,A])=>{u.setError(a,{type:"manual",message:A.join(", ")})});else{let a="حدث خطأ أثناء إرسال البيانات. يرجى المحاولة مرة أخرى.";t.response?a=t.response.data.msg||a:t.request&&(a="تعذر الاتصال بالخادم. يرجى التحقق من اتصالك بالإنترنت."),c(a)}}finally{_(!1)}};return i.jsxs(i.Fragment,{children:[i.jsx(z,{...u,children:i.jsxs("form",{onSubmit:u.handleSubmit(P),className:"mb-8",children:[i.jsx(F,{text:"بيانات العميل"}),i.jsx(D,{}),i.jsx(F,{text:"المستندات الشخصية",className:"mb-6"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsx(g,{name:"personal_id_img_front",maxSize:10*1024*1024,multiple:!1,label:"الهوية الشخصيه ( الامام )"}),i.jsx(g,{name:"personal_id_img_back",maxSize:10*1024*1024,multiple:!1,label:"الهوية الشخصية ( الخلف )"}),i.jsx(g,{name:"driver_license_img_front",maxSize:10*1024*1024,multiple:!1,label:"الرخصة ( الامام )"}),i.jsx(g,{name:"driver_license_img_back",maxSize:10*1024*1024,multiple:!1,label:"الرخصة ( الخلف )"})]}),b&&i.jsx("div",{className:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg",children:i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{children:b}),i.jsx("button",{onClick:()=>c(null),className:"text-red-700 hover:text-red-900",children:"×"})]})}),i.jsxs("div",{className:"flex flex-row justify-between items-center mt-8",children:[e?i.jsx(I,{type:"button",className:"xl:px-[101px] xl:py-[18px] text-[#A21515] border border-red-error-50 xl:font-bold bg-red-error-50",onClick:()=>m(!0),children:"إلغاء الطلب"}):i.jsx(I,{type:"button",className:"xl:px-[64.5px] xl:py-[18px] border border-r-red-error-50 bg-red-error-50 text-[#A21515] xl:font-bold",onClick:()=>m(!0),children:"الغاء"}),i.jsx("div",{children:e?i.jsx(S,{className:"xl:px-[107px] xl:py-[18px] xl:font-bold ms-6",disabled:o,children:o?"جاري التحميل...":"حفظ التغييرات"}):i.jsx(S,{className:"xl:px-[107px] xl:py-[18px] xl:font-bold ms-6",disabled:o,children:o?"جاري التحميل...":"اضافة"})})]})]})}),i.jsx($,{open:w,onClickButton1:()=>{m(!1)},onClickButton2:()=>{h("/customer-relations"),m(!1)},text1:e?"إلغاء تعديل بيانات العميل":"إلغاء إضافة عميل",text2:e?"أنت على وشك إلغاء عملية تعديل بيانات العميل. سيتم تجاهل جميع البيانات المدخلة، هل أنت متأكد؟":"أنت على وشك إلغاء عملية إضافة عميل جديد دون إكمال البيانات المطلوبة. سيتم تجاهل جميع البيانات المدخلة، هل أنت متأكد؟",textButton1:"إكمال الطلب",textButton2:"إلغاء الطلب"}),i.jsx(O,{open:q,text1:e?"تم تعديل البيانات بنحاح":"تم إضافة عميل جديد بنحاح",text2:e?"تم تعديل بيانات العميل الجديد بنجاح.":"تم تسجيل بيانات العميل الجديد بنجاح.",textButton2:e?"تعديل بيانات اخرى":"إضافة عميل أخر",textButton1:"العودة لقائمة العملاء",onAddAnother:E,onReturnToList:()=>{h("/customer-relations"),x(!1)}})]})}export{U as A};
//# sourceMappingURL=AddCustomerForm-dnQ1WQ3a.js.map
