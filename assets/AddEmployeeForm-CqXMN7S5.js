import{j as e,r as u,k as W,e as N,d as $}from"./index-CG21Kl6L.js";import{u as z}from"./index-BrlmtnpO.js";import{S as I}from"./SecondaryButton-C8PAsQMM.js";import{I as H}from"./ImportIcon-DAcZLaTm.js";import{D as Y}from"./DateInputForm-Bteneik4.js";import{f as M,a as V,b as R,c as U,d as O,e as T,z as s,u as G,t as Z,F as J}from"./index-CVKxZN6H.js";import{r as X}from"./removeDuplicated-BgoSiW5F.js";import{T as j}from"./TextInputForm-ML6m37PA.js";import{S as w}from"./SelectInputForm-nhbT-0nq.js";import{S as K,a as Q,b as y,c as rr,d as er}from"./select-cvP0Sup0.js";import{C as tr}from"./CalendarIcon-vdySZVWB.js";import{S as P}from"./SearchableSelectInputForm-B2qBDSGN.js";import{b as A,a as sr}from"./axios-utils-DWLLXNPU.js";import{M as L}from"./MainHeading-D0_31WmT.js";import{S as ar}from"./SuccessPopup-CoLlaGCA.js";import{P as D}from"./PrimaryButton-CqSNXaEZ.js";import{C as nr}from"./CancelPopup-DkpTHoXx.js";import{f as ir}from"./format-D6Kkl3rb.js";function Pr(){const r=x=>{x[0]},{getRootProps:t,getInputProps:n}=z({onDrop:r,multiple:!1,maxSize:10485760});return e.jsx("div",{className:"grid grid-cols-1",children:e.jsxs("div",{...t(),children:[e.jsx("input",{...n()}),e.jsxs(I,{className:"py-[10px]",type:"button",children:[e.jsx(H,{}),"استيراد ملف بيانات"]})]})})}const dr=({width:r="33",height:t="32",className:n=""})=>e.jsx("span",{className:n,children:e.jsxs("svg",{width:r,height:t,viewBox:"0 0 33 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M12.4999 13.3333C13.9727 13.3333 15.1666 12.1394 15.1666 10.6667C15.1666 9.19391 13.9727 8 12.4999 8C11.0272 8 9.83325 9.19391 9.83325 10.6667C9.83325 12.1394 11.0272 13.3333 12.4999 13.3333Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M17.8334 2.6665H12.5001C5.83341 2.6665 3.16675 5.33317 3.16675 11.9998V19.9998C3.16675 26.6665 5.83341 29.3332 12.5001 29.3332H20.5001C27.1667 29.3332 29.8334 26.6665 29.8334 19.9998V13.3332",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M21.5 6.6665H28.8333",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M25.1667 10.3333V3",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M4.06006 25.2666L10.6334 20.8532C11.6867 20.1466 13.2067 20.2266 14.1534 21.0399L14.5934 21.4266C15.6334 22.3199 17.3134 22.3199 18.3534 21.4266L23.9001 16.6666C24.9401 15.7732 26.6201 15.7732 27.6601 16.6666L29.8334 18.5332",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})}),C=({className:r,name:t,label:n,maxSize:x,multiple:d,editImages:a})=>{const{control:o,setValue:i,watch:m,getValues:p}=M(),[b,g]=u.useState([]),f=c=>{const l=p(t),h=Array.isArray(l)?l.filter((S,F)=>F!==c):[];i(t,h,{shouldValidate:!0}),g(S=>S.filter((q,v)=>(v===c&&URL.revokeObjectURL(S[v]),v!==c)))},E=(c,l)=>{if(d&&a){const h=p(l),F=[...Array.isArray(h)?h:[],...c];i(l,X(F),{shouldValidate:!0});const q=c.map(v=>URL.createObjectURL(v));g(v=>[...v,...q])}else i(l,d?c:c[0],{shouldValidate:!0}),g(c.map(h=>URL.createObjectURL(h)))},_=m(t);return u.useEffect(()=>{(!_||_.length===0)&&g([])},[_]),u.useEffect(()=>{a&&(i(t,a,{shouldValidate:!0}),g(Array.isArray(a)?a:[a]))},[]),e.jsx(V,{control:o,name:t,render:({field:c})=>e.jsxs(R,{className:r,children:[e.jsx(U,{className:"text-primery-blue-900 font-medium text-[18px] leading-[33.73px] tracking-normal text-start",children:n}),e.jsx(O,{children:e.jsx(or,{onDrop:l=>E(l,t),acceptedFiles:c.value,previews:b,maxSize:x,multiple:d,removeImage:f})}),e.jsx(T,{})]})})};function or({onDrop:r,previews:t,maxSize:n,multiple:x,removeImage:d}){const{getRootProps:a,getInputProps:o}=z({onDrop:r,accept:{"image/*":[]},multiple:x,maxSize:n});return e.jsxs("div",{...a(),className:"border-2 border-dashed border-[#B6B5BF] rounded-lg p-2 text-center cursor-pointer",children:[e.jsx("input",{...o()}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col gap-4 justify-center items-center",children:[e.jsx(dr,{className:"text-[#90868C] "}),e.jsx("div",{className:"text-[#90868C] text-base leading-5 tracking-normal font-medium",children:e.jsx(I,{type:"button",children:"اختر صورة"})})]}),e.jsx("div",{className:"flex flex-row justify-center gap-2 mt-6 border-2 border-dashed border-[#B6B5BF] rounded-lg h-[60px]",children:t==null?void 0:t.map((i,m)=>e.jsxs("div",{className:"relative group flex flex-col items-center text-sm text-muted-foreground",children:[e.jsx("img",{src:i,alt:`Preview ${m+1}`,className:"w-20 h-[60px] object-cover rounded-md"}),e.jsx("button",{type:"button",onClick:p=>{p.stopPropagation(),d(m)},className:"absolute w-6 h-6 top-1 start-1 bg-red-error-600 text-white-blue-50 p-1 rounded-full text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:"✕"})]},m))})]})]})}function cr({image:r}){return e.jsxs("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-[1fr_1fr_164px] gap-6",children:[e.jsxs("div",{children:[e.jsx(j,{name:"name",label:"اسم الموظف",placeholder:"ادخل اسم الموظف"}),e.jsx(j,{name:"id_number",label:"رقم الهوية",placeholder:"ادخل رقم الهوية"}),e.jsx(j,{label:"رقم الهاتف",placeholder:"ادخل رقم الهاتف",className:"[&>input]:text-end [&>input]:placeholder:text-end",name:"phone_number",type:"tel"})]}),e.jsxs("div",{children:[e.jsx(j,{name:"address",label:"العنوان",placeholder:"ادخل العنوان"}),e.jsx(Y,{name:"birth_date",label:"تاريخ الميلاد",placeholder:"ادخل تاريخ الميلاد"}),e.jsx(j,{name:"email",label:"البريد الالكتروني",placeholder:"ادخل البريد الالكتروني"})]}),e.jsx("div",{children:r?e.jsx(C,{name:"personal_image",maxSize:10*1024*1024,multiple:!1,label:"الصورة شخصية",editImages:r}):e.jsx(C,{name:"personal_image",maxSize:10*1024*1024,multiple:!1,label:"الصورة شخصية"})})]})}function lr({data:r,className:t,name:n,label:x,placeholder:d}){const{control:a}=M();return e.jsx(V,{control:a,name:n,render:({field:o})=>e.jsxs(R,{className:W("flex flex-col justify-start",{className:t}),children:[e.jsx(U,{className:"text-primery-blue-900 font-medium text-[18px] leading-[33.73px] tracking-normal text-start",children:x}),e.jsxs(K,{onValueChange:o.onChange,value:r&&String(o.value),children:[e.jsx(O,{children:e.jsx(Q,{className:"w-full text-black",Icon:e.jsx(tr,{width:"24",height:"24",className:"text-white-blue-600"}),children:e.jsx(y,{placeholder:e.jsx("span",{style:{color:"#D1D1D1"},children:d})})})}),e.jsx(rr,{children:Array.from({length:new Date().getFullYear()-1900+1},(i,m)=>1900+m).map(i=>e.jsx(er,{value:String(i),children:i},i))})]}),e.jsx(T,{})]})})}function ur({image:r}){return e.jsxs("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-[1fr_1fr_164px] gap-6",children:[e.jsxs("div",{children:[e.jsx(w,{name:"education_degree",label:"درجة الشهادة",options:[{value:"high_school",name:"الثانوية العامة"},{value:"bachelor",name:"بكالوريوس"},{value:"master",name:"ماجستير"},{value:"phd",name:"دكتوراه"}],placeholder:"ادخل درجة الشهادة"}),e.jsx(j,{name:"specialization",label:"التخصص",placeholder:"ادخل التخصص"}),e.jsx(j,{name:"previous_experience",label:"الخبرات السابقة",placeholder:"ادخل الخبارات السابقة"})]}),e.jsxs("div",{children:[e.jsx(j,{name:"university",label:"الجامعة",placeholder:"ادخل اسم الجامعة"}),e.jsx(lr,{name:"graduation_year",data:!0,label:"سنة التخرج",placeholder:"اختر سنة التخرج"}),e.jsx(j,{name:"skills",label:"المهارات",placeholder:"ادخل المهارات"})]}),e.jsx("div",{children:r?e.jsx(C,{name:"degree_certificate",maxSize:10*1024*1024,multiple:!1,label:"الشهادات",editImages:r}):e.jsx(C,{name:"degree_certificate",maxSize:10*1024*1024,multiple:!1,label:"الشهادات"})})]})}function xr({image:r}){const[t,n]=u.useState([]),[x,d]=u.useState(null);u.useEffect(()=>{(async()=>{try{const g=(await A({endpoint:N.branch.list})).data.data.data.map(f=>({name:f.name,value:String(f.id)}));n(g),d(null)}catch{d("Error fetching branches. Please try again later.")}})()},[]);const[a,o]=u.useState([]),[i,m]=u.useState(null);return u.useEffect(()=>{(async()=>{try{const g=(await A({endpoint:N.shifts.list})).data.data.map(f=>({name:f.name,value:String(f.id)}));o(g),m(null)}catch{m("Error fetching shifts. Please try again later.")}})()},[]),e.jsxs("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-[1fr_1fr_164px] gap-6",children:[e.jsxs("div",{children:[e.jsx(j,{name:"employee_number",label:"كود الموظف",placeholder:"ادخل كود الموظف"}),e.jsx(w,{name:"department",label:"القسم",options:[{value:"high_school",name:"الثانوية العامة"},{value:"bachelor",name:"بكالوريوس"},{value:"master",name:"ماجستير"},{value:"phd",name:"دكتوراه"}],placeholder:"اختر  القسم"})]}),e.jsxs("div",{children:[e.jsx(w,{name:"position",label:"الوظيفة",options:[{value:"high_school",name:"الثانوية العامة"},{value:"bachelor",name:"بكالوريوس"},{value:"master",name:"ماجستير"},{value:"phd",name:"دكتوراه"}],placeholder:"اختر الوظيفة"}),e.jsx(P,{name:"branch_id",label:"الفرع",placeholder:"اختر الفرع",options:t,error:x,data:!0}),e.jsx(w,{name:"contract_type",label:"نوع التعاقد",options:[{value:"high_school",name:"الثانوية العامة"},{value:"bachelor",name:"بكالوريوس"},{value:"master",name:"ماجستير"},{value:"phd",name:"دكتوراه"}],placeholder:"ادخل نوع التعاقد"}),e.jsx(P,{name:"shift_id",label:"الوردية",placeholder:"اختر الوردية",options:a,error:i,data:!0})]}),e.jsx("div",{children:r?e.jsx(C,{name:"attachment",maxSize:10*1024*1024,multiple:!1,label:"الشهادات",editImages:r}):e.jsx(C,{name:"attachment",maxSize:10*1024*1024,multiple:!1,label:"الشهادات"})})]})}const k=10*1024*1024,B=["image/jpeg","image/png","image/jpg","image/gif","image/svg+xml"],hr=s.object({name:s.string().min(1,"Name is required"),address:s.string().min(1,"Address is required"),id_number:s.string().min(1,"The personal id number field is required."),birth_date:s.date({required_error:"Birth date is required"}),phone_number:s.string().min(1,"رقم الهاتف مطلوب").refine(r=>/^\d+$/.test(r),"الرجاء إدخال أرقام فقط").refine(r=>r.length>=8&&r.length<=15,"يجب أن يتكون رقم الهاتف من 8 إلى 15 رقم"),email:s.string().min(1,"The email field is required.").email("Please enter a valid email address."),personal_image:s.instanceof(File,{message:"Image is required"}).refine(r=>r.size<=k,`Image must be less than ${k}MB`).refine(r=>B.includes(r.type),"Only .jpeg, .png, .jpg, .gif, and .svg formats are allowed"),education_degree:s.string().min(1,"Education degree is required"),university:s.string().min(1,"University is required"),specialization:s.string().min(1,"Spexialization is required"),graduation_year:s.string({required_error:"Graduation year is required"}),skills:s.string().min(1,"Skills is required"),previous_experience:s.string().min(1,"Pervious experience is required"),degree_certificate:s.instanceof(File,{message:"Image is required"}).refine(r=>r.size<=k,`Image must be less than ${k}MB`).refine(r=>B.includes(r.type),"Only .jpeg, .png, .jpg, .gif, and .svg formats are allowed"),employee_number:s.string().min(1,"Employee code is required"),department:s.string().min(1,"Department is required"),position:s.string().min(1,"Position name is required"),branch_id:s.string().min(1,"Branch is required"),contract_type:s.string().min(1,"Contract type is required"),shift_id:s.string().min(1,"Shift is required"),attachment:s.instanceof(File,{message:"Image is required"}).refine(r=>r.size<=k,`Image must be less than ${k}MB`).refine(r=>B.includes(r.type),"Only .jpeg, .png, .jpg, .gif, and .svg formats are allowed")});function mr({employee:r,setShowCancelPopup:t,setShowSuccessPopup:n,showCancelPopup:x,showSuccessPopup:d,loading:a}){const o=$(),i=()=>{n(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-row justify-end items-center mt-8",children:[r?e.jsx(I,{type:"button",className:"xl:px-[87px] xl:py-3 text-[#A21515] border border-red-error-50 xl:font-semibold bg-red-error-50",onClick:()=>t(!0),children:"إلغاء الشكوى"}):e.jsx(I,{type:"button",className:"xl:px-[87px] bg-red-error-50 text-[#A21515] hover:bg-red-error-600 hover:text-white-blue-50 xl:py-3 border bordr-[#E8EFF6] xl:font-semibold",onClick:()=>t(!0),children:"الغاء"}),e.jsx("div",{children:r?e.jsx(D,{className:"xl:px-[91px] xl:py-3 xl:font-semibold ms-6",disabled:a,children:a?"جاري التحميل...":"حفظ التغييرات"}):e.jsx(D,{className:"xl:px-[91px] xl:py-3 xl:font-semibold ms-6",disabled:a,children:a?"جاري التحميل...":"اضافة"})})]}),e.jsx(nr,{open:x,onClickButton1:()=>{t(!1)},onClickButton2:()=>{o("/human-resources"),t(!1)},text1:r?"إلغاء تعديل بيانات الموظف":"إلغاء إضافة موظف",text2:r?"أنت على وشك إلغاء عملية تعديل بيانات الموظف دون إكمال البيانات المطلوبة. سيتم تجاهل جميع البيانات المدخلة، هل أنت متأكد؟":"أنت على وشك إلغاء عملية إضافة موظف جديد دون إكمال البيانات المطلوبة. سيتم تجاهل جميع البيانات المدخلة، هل أنت متأكد؟",textButton1:r?"إكمال التعديل":"إكمال الإضافة",textButton2:r?"إلغاء التعديل":"إلغاء الإضافة"}),e.jsx(ar,{text1:r?"تم تعديل بيانات الموظف بنحاح":"تم إضافة موظف جديد بنحاح",text2:r?"تم تعديل بيانات الموظف بنحاح":"تم تسجيل بيانات الموظف الجديد بنجاح.",textButton1:"العودة لقائمة الموظفين",textButton2:r?"تعديل بيانات اخرى":"إضافة موظف أخر",open:d,onAddAnother:i,onReturnToList:()=>{o("/human-resources"),n(!1)}})]})}function Ar({employee:r}){const[t,n]=u.useState(null),[x,d]=u.useState(!1),[a,o]=u.useState(!1),[i,m]=u.useState(!1),p=u.useMemo(()=>({name:(r==null?void 0:r.name)||"",address:(r==null?void 0:r.address)||"",id_number:(r==null?void 0:r.id_number)||"",birth_date:r!=null&&r.birth_date?new Date(r.birth_date):void 0,phone_number:(r==null?void 0:r.phone_number)||"",email:(r==null?void 0:r.email)||"",education_degree:(r==null?void 0:r.education_degree)||"",university:(r==null?void 0:r.university)||"",specialization:(r==null?void 0:r.specialization)||"",graduation_year:(r==null?void 0:r.graduation_year)||void 0,skills:(r==null?void 0:r.skills)||void 0,previous_experience:(r==null?void 0:r.previous_experience)||void 0,employee_number:(r==null?void 0:r.employee_number)||"",department:(r==null?void 0:r.department)||"",position:(r==null?void 0:r.position)||"",branch_id:r!=null&&r.branch_id?String(r.branch_id):"",shift_id:r!=null&&r.shift_id?String(r.shift_id):"",contract_type:(r==null?void 0:r.contract_type)||""}),[r]),b=G({resolver:Z(hr),defaultValues:p}),g=async f=>{var _,c;d(!0),n(null);const E={...f,birth_date:ir(f.birth_date,"yyyy-MM-dd")};try{await sr({endpoint:r?N.employee.update+r.id:N.employee.create,body:E,config:{headers:{"Content-Type":"multipart/form-data"}}}),o(!0)}catch(l){if((c=(_=l.response)==null?void 0:_.data)!=null&&c.errors)Object.entries(l.response.data.errors).forEach(([h,S])=>{b.setError(h,{type:"manual",message:S.join(", ")})});else{let h="حدث خطأ أثناء إرسال البيانات. يرجى المحاولة مرة أخرى.";l.response?h=l.response.data.msg||h:l.request&&(h="تعذر الاتصال بالخادم. يرجى التحقق من اتصالك بالإنترنت."),n(h)}}finally{d(!1)}};return e.jsx(e.Fragment,{children:e.jsx(J,{...b,children:e.jsxs("form",{onSubmit:b.handleSubmit(g),className:"mb-8",children:[t&&e.jsx("div",{className:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"",children:t}),e.jsx("button",{onClick:()=>n(null),className:"text-red-700 hover:text-red-900",children:"×"})]})}),e.jsxs("div",{children:[e.jsx(L,{text:"البيانات الشخصية"}),e.jsx(cr,{image:r==null?void 0:r.personal_image}),e.jsx(L,{text:"المؤهلات والخبرات"}),e.jsx(ur,{image:r==null?void 0:r.degree_certificate}),e.jsx(L,{text:"البيانات الوظيفية"}),e.jsx(xr,{image:r==null?void 0:r.attachment})]}),e.jsx(mr,{employee:r,loading:x,setShowCancelPopup:m,setShowSuccessPopup:o,showCancelPopup:i,showSuccessPopup:a})]})})})}export{Ar as A,Pr as D};
//# sourceMappingURL=AddEmployeeForm-CqXMN7S5.js.map
