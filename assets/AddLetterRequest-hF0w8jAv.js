import{r as j,j as e,d as D,e as F,t as L,k as A}from"./index-CG21Kl6L.js";import{D as H,a as V,b as P}from"./dialog-BNTutzAA.js";import{z as v,f as R,a as M,b as S,c as q,d as E,e as T,u as U,t as B,F as Z}from"./index-CVKxZN6H.js";import{a as _}from"./axios-utils-DWLLXNPU.js";import{S as k}from"./SecondaryButton-C8PAsQMM.js";import{P as O}from"./PrimaryButton-CqSNXaEZ.js";import{T as I}from"./TextInputForm-ML6m37PA.js";import{T as z}from"./TextAreaInputForm-DDtw8I0I.js";import{u as W}from"./index-BrlmtnpO.js";import{r as $}from"./removeDuplicated-BgoSiW5F.js";const G=v.object({letter_for:v.string().min(1,"This field is required"),note:v.string().min(1,"This field is required"),attachment:v.instanceof(File,{message:"File is required"})}),J=({className:r,name:t,label:n,maxSize:f,multiple:l,editImages:a})=>{const{control:p,setValue:c,watch:m,getValues:d}=R(),[y,x]=j.useState([]),g=s=>{const o=d(t),h=Array.isArray(o)?o.filter((w,C)=>C!==s):[];c(t,h,{shouldValidate:!0}),x(w=>w.filter((N,u)=>(u===s&&URL.revokeObjectURL(w[u]),u!==s)))},b=(s,o)=>{if(l&&a){const h=d(o),C=[...Array.isArray(h)?h:[],...s];c(o,$(C),{shouldValidate:!0});const N=s.map(u=>URL.createObjectURL(u));x(u=>[...u,...N])}else c(o,l?s:s[0],{shouldValidate:!0}),x(s.map(h=>URL.createObjectURL(h)))},i=m(t);return j.useEffect(()=>{(!i||i.length===0)&&x([])},[i]),j.useEffect(()=>{a&&(c(t,a,{shouldValidate:!0}),x(Array.isArray(a)?a:[a]))},[]),e.jsx(M,{control:p,name:t,render:({field:s})=>e.jsxs(S,{className:r,children:[e.jsx(q,{className:"text-primery-blue-900 font-medium text-[18px] leading-[33.73px] tracking-normal text-start",children:n}),e.jsx(E,{children:e.jsx(K,{onDrop:o=>b(o,t),acceptedFiles:s.value,previews:y,maxSize:f,multiple:l,removeImage:g})}),e.jsx(T,{})]})})};function K({onDrop:r,previews:t,maxSize:n,multiple:f,removeImage:l}){const{getRootProps:a,getInputProps:p}=W({onDrop:r,accept:{"application/pdf":[],"image/*":[]},multiple:f,maxSize:n});return e.jsxs("div",{...a(),className:"border-2 border-dashed border-primery-blue-500 rounded-lg p-4 text-center cursor-pointer",children:[e.jsx("input",{...p()}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-row items-center justify-between text-base leading-5 tracking-normal font-medium",children:[e.jsxs("div",{className:"flex flex-row items-center gap-2 mb-5",children:[e.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M10.7521 23.4006C10.366 25.0819 8.41456 26.783 6.31738 25.3982C6.31738 25.3982 7.67526 26.605 10.4333 26.605H22.4646C23.9666 26.605 25.2654 25.5577 25.5843 24.0894L27.0886 16.6907C27.5357 14.373 26.0064 13.2734 23.9703 13.2734H15.5231C14.0248 13.2734 12.7272 14.3158 12.4059 15.7791L10.7521 23.4006Z",stroke:"#145DA0",strokeWidth:"1.44",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M10.4339 26.6056C6.46498 26.6056 4.12744 24.2731 4.12744 20.314V11.685C4.12744 7.73098 5.58202 5.39844 9.54101 5.39844H11.754C12.5485 5.39844 13.2958 5.77329 13.7715 6.40842L14.7815 7.75215C15.2597 8.38605 16.0081 8.75965 16.8026 8.76214H18.6707C22.0917 8.76214 23.6522 10.2628 24.017 13.2641",stroke:"#145DA0",strokeWidth:"1.44",strokeLinecap:"round",strokeLinejoin:"round"})]}),e.jsx("p",{className:"font-medium text-sm text-[#2D2D3A]",children:"قم برفع ملف أو قم سحبه هنا"})]}),e.jsx(k,{type:"button",className:"h-[30px]",children:"اختيار الملف"})]}),e.jsx("div",{className:"flex flex-row justify-center gap-2 border-2 border-dashed border-primery-blue-500 rounded-lg p-8",children:t==null?void 0:t.map((c,m)=>e.jsxs("div",{className:"relative group flex flex-col items-center text-sm text-muted-foreground",children:[e.jsx("img",{src:c,alt:`Preview ${m+1}`,className:"w-20 h-20 object-cover rounded-md"}),e.jsx("button",{type:"button",onClick:d=>{d.stopPropagation(),l(m)},className:"absolute w-6 h-6 top-1 start-1 bg-red-error-600 text-white-blue-50 p-1 rounded-full text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:"✕"})]},m))}),e.jsx("div",{children:e.jsxs("ul",{className:"text-xs leading-[22.5px] font-medium tracking-normal text-start text-[#90868C] list-[square] marker:text-[8px] ps-5 mt-2",children:[e.jsxs("li",{children:["اقصى حجم ",e.jsxs("span",{className:"font-bold ms-[2px]",children:[n/1024/1024,"MB"]})]}),e.jsxs("li",{children:["الملفات المسموح بها",e.jsx("span",{className:"font-bold ms-[2px]",children:"pdf"})]})]})})]})]})}function Q({employee:r,setAddLetter:t,handleRefreshTable:n}){const[f,l]=j.useState(null),[a,p]=j.useState(!1),c=D(),m=j.useMemo(()=>({}),[r]),d=U({resolver:B(G),defaultValues:m}),y=async x=>{var g,b;p(!0),l(null);try{await _({endpoint:r?F.letterRequests.update+r.id:F.letterRequests.create,body:{data:x},config:{headers:{"Content-Type":"multipart/form-data"}}}),L("تم اضافة الطلب بنجاح"),t(!1),n(),c("/self-services/services")}catch(i){if((b=(g=i.response)==null?void 0:g.data)!=null&&b.errors)Object.entries(i.response.data.errors).forEach(([s,o])=>{d.setError(s,{type:"manual",message:o.join(", ")})});else{let s="حدث خطأ أثناء إرسال البيانات. يرجى المحاولة مرة أخرى.";i.response?s=i.response.data.msg||s:i.request&&(s="تعذر الاتصال بالخادم. يرجى التحقق من اتصالك بالإنترنت."),l(s)}}finally{p(!1)}};return e.jsx(e.Fragment,{children:e.jsx(Z,{...d,children:e.jsxs("form",{onSubmit:d.handleSubmit(y),className:"mt-6",children:[f&&e.jsx("div",{className:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"",children:f}),e.jsx("button",{onClick:()=>l(null),className:"text-red-700 hover:text-red-900",children:"×"})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-x-6",children:[e.jsx(I,{name:"letter_for",label:"الجهة الموجهه اليها",placeholder:"شركة بن لادن"}),e.jsx(z,{className:"flex flex-col min-h-[130px]",name:"note",label:"ملاحظات اضافية",placeholder:"اكتب ملاحظات اضافية"}),e.jsx(J,{name:"attachment",label:"رفع ملف",multiple:!1,maxSize:10*1024*1024})]}),e.jsxs("div",{className:"flex flex-row gap-4 mt-12",children:[e.jsx(k,{onClick:()=>t(!1),type:"button",className:"w-full text-base leading-5 tracking-normal py-[10px] font-medium",children:"إلغاء"}),e.jsx(O,{type:"submit",className:"w-full text-base leading-5 tracking-normal font-medium py-[10px]",children:a?"جاري الحفظ...":"حفظ"})]})]})})})}function ne({open:r,setAddLetter:t,handleRefreshTable:n}){return e.jsxs(H,{open:r,children:[e.jsx("div",{className:A("fixed inset-0 bg-black/50",{"!hidden":!r})}),e.jsxs(V,{showCloseButton:!1,className:"max-w-[623px] rounded-lg p-8 bg-white-blue-50 font-cairo gap-0 [&_[aria-label=Close]]:opacity-0",children:[e.jsxs(P,{className:"flex flex-col items-center",children:[e.jsx("div",{className:"flex flex-row justify-between mb-4 w-full",children:e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsxs("svg",{width:"25",height:"25",viewBox:"0 0 25 25",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{opacity:"0.4",d:"M21.5 7.5V17.5C21.5 20.5 20 22.5 16.5 22.5H8.5C5 22.5 3.5 20.5 3.5 17.5V7.5C3.5 4.5 5 2.5 8.5 2.5H16.5C20 2.5 21.5 4.5 21.5 7.5Z",fill:"#125592"}),e.jsx("path",{d:"M19 9.75H17C15.48 9.75 14.25 8.52 14.25 7V5C14.25 4.59 14.59 4.25 15 4.25C15.41 4.25 15.75 4.59 15.75 5V7C15.75 7.69 16.31 8.25 17 8.25H19C19.41 8.25 19.75 8.59 19.75 9C19.75 9.41 19.41 9.75 19 9.75Z",fill:"#145DA0"}),e.jsx("path",{d:"M12.5 14.25H8.5C8.09 14.25 7.75 13.91 7.75 13.5C7.75 13.09 8.09 12.75 8.5 12.75H12.5C12.91 12.75 13.25 13.09 13.25 13.5C13.25 13.91 12.91 14.25 12.5 14.25Z",fill:"#145DA0"}),e.jsx("path",{d:"M16.5 18.25H8.5C8.09 18.25 7.75 17.91 7.75 17.5C7.75 17.09 8.09 16.75 8.5 16.75H16.5C16.91 16.75 17.25 17.09 17.25 17.5C17.25 17.91 16.91 18.25 16.5 18.25Z",fill:"#145DA0"})]}),e.jsx("h3",{className:"text-[22px] font-bold text-primery-blue-500",children:"طلب اصدار خطاب"})]})}),e.jsx("div",{className:"w-full border-b border-[#D1D1D1] !mt-0"})]}),e.jsx(Q,{setAddLetter:t,handleRefreshTable:n})]})]})}export{ne as A,J as F};
//# sourceMappingURL=AddLetterRequest-hF0w8jAv.js.map
