import{j as a,r as s,d as A,e as _,t as k}from"./index-BYyXun5x.js";import{f as C,a as I,b as T,c as M,d as P,e as D,z as r,u as L,t as B,F as z}from"./index-C2_QJ2lf.js";import{a as G,b as H}from"./axios-utils-AvuZ81CO.js";import{T as o}from"./TimeInputForm-zvEH8xvK.js";import{S as O}from"./SecondaryButton-DL_Bkgwn.js";import{P as R}from"./PrimaryButton-CZnRZgcz.js";import{S as V}from"./SearchableSelectInputForm-v1_SI72T.js";import{S as $}from"./SelectInputForm-CG_Opxs4.js";import{M as j}from"./MainHeading-DYhLcFx9.js";import{S as J}from"./switch-K1kCIRsm.js";import{T as E}from"./TextInputForm-DXNY8AYK.js";function t({className:e,name:u,label:m}){const{control:y}=C();return a.jsx(I,{control:y,name:u,render:({field:d})=>a.jsxs(T,{className:e,children:[a.jsx(M,{className:"!mt-0 ms-2 items-center tracking-normal text-start text-[#080614] text-base font-bold leading-[100%]",children:m}),a.jsx(P,{children:a.jsx(J,{dir:"ltr",className:"data-[state=checked]:bg-primery-blue-600 !mt-0",checked:d.value,onCheckedChange:d.onChange})}),a.jsx(D,{})]})})}const K=r.object({name:r.string().min(1,"Name field is required."),type:r.string().min(1,"Type name field is required."),sunday:r.boolean(),monday:r.boolean(),tuesday:r.boolean(),wednesday:r.boolean(),thursday:r.boolean(),friday:r.boolean(),saturday:r.boolean(),shift_start_time:r.string().min(1,"Shift start is required"),shift_end_time:r.string().min(1,"Shift end is required"),late_entry_time:r.string().min(1,"Late entry is required"),early_entry_time:r.string().min(1,"Early entry is required"),late_exit_time:r.string().min(1,"late Exit is required"),early_exit_time:r.string().min(1,"Early exit is required"),delay_minutes:r.string().min(1,"Delay minutes is required"),delay_calculation_method:r.string().min(1,"Delay calculation method is required")});function te({shift:e}){const[u,m]=s.useState(null),[y,d]=s.useState(!1),[N,w]=s.useState([]),[S,g]=s.useState(null),f=A(),F=s.useMemo(()=>({name:(e==null?void 0:e.name)||"",type:(e==null?void 0:e.type)||"",sunday:(e==null?void 0:e.sunday)||!1,monday:(e==null?void 0:e.monday)||!1,tuesday:(e==null?void 0:e.tuesday)||!1,wednesday:(e==null?void 0:e.wednesday)||!1,thursday:(e==null?void 0:e.thursday)||!1,friday:(e==null?void 0:e.friday)||!1,saturday:(e==null?void 0:e.saturday)||!1,shift_start_time:(e==null?void 0:e.shift_start_time)||"",shift_end_time:(e==null?void 0:e.shift_end_time)||"",early_entry_time:(e==null?void 0:e.early_entry_time)||"",early_exit_time:(e==null?void 0:e.early_exit_time)||"",late_entry_time:(e==null?void 0:e.late_entry_time)||"",late_exit_time:(e==null?void 0:e.late_exit_time)||"",delay_minutes:(e==null?void 0:e.delay_minutes)||"",delay_calculation_method:(e==null?void 0:e.delay_calculation_method)||""}),[e]),p=L({resolver:B(K),defaultValues:F}),v=async l=>{var x,c;d(!0),m(null);const b={...l,sunday:l.sunday?1:0,monday:l.monday?1:0,tuesday:l.tuesday?1:0,wednesday:l.wednesday?1:0,thursday:l.thursday?1:0,friday:l.friday?1:0,saturday:l.saturday?1:0};try{await G({endpoint:e?_.shifts.update+e.id:_.shifts.create,body:b,config:{headers:{"Content-Type":"multipart/form-data"}}}),f("/human-resources/shifts"),k(`${e?"تم تعديل الوردية بنجاح":"تم اضافة الوردية بنجاح"}`)}catch(i){if((c=(x=i.response)==null?void 0:x.data)!=null&&c.errors)Object.entries(i.response.data.errors).forEach(([n,q])=>{p.setError(n,{type:"manual",message:q.join(", ")})});else{let n="حدث خطأ أثناء إرسال البيانات. يرجى المحاولة مرة أخرى.";i.response?n=i.response.data.msg||n:i.request&&(n="تعذر الاتصال بالخادم. يرجى التحقق من اتصالك بالإنترنت."),m(n)}}finally{d(!1)}};return s.useEffect(()=>{(async()=>{try{const x=(await H({endpoint:_.shifts.list})).data.data.map(c=>({name:c.name,value:String(c.name)}));w(x),g(null)}catch{g("Error fetching shifts. Please try again later.")}})()},[]),a.jsx(a.Fragment,{children:a.jsx(z,{...p,children:a.jsxs("form",{onSubmit:p.handleSubmit(v),className:"mt-6 mb-24",children:[u&&a.jsx("div",{className:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"",children:u}),a.jsx("button",{onClick:()=>m(null),className:"text-red-700 hover:text-red-900",children:"×"})]})}),a.jsx(j,{text:"تفاصيل الوردية"}),a.jsxs("div",{className:"grid grid-cols-2 gap-x-12",children:[a.jsx(V,{name:"name",placeholder:"بحث عن اسم أو كود العميل",label:"اسم العميل",options:N,error:S,data:!0}),a.jsx($,{name:"type",options:[{name:"صباحى",value:"am"},{name:"مسائى",value:"pm"}],label:"النوع",placeholder:"صباحى - مسائى"})]}),a.jsx(j,{text:"أيام العمل",className:"mt-6"}),a.jsxs("div",{className:"mt-8 mb-8 grid grid-cols-2 gap-6",children:[a.jsx(t,{className:"w-full border border-[#E8E7EA] rounded-xl px-4 py-[26px] flex justify-between items-center",name:"sunday",label:"الأحد"}),a.jsx(t,{className:"w-full border border-[#E8E7EA] rounded-xl px-4 py-[26px] flex justify-between items-center",name:"monday",label:"الإثنين"}),a.jsx(t,{className:"w-full border border-[#E8E7EA] rounded-xl px-4 py-[26px] flex justify-between items-center",name:"tuesday",label:"الثلاثاء"}),a.jsx(t,{className:"w-full border border-[#E8E7EA] rounded-xl px-4 py-[26px] flex justify-between items-center",name:"wednesday",label:"الأربعاء"}),a.jsx(t,{className:"w-full border border-[#E8E7EA] rounded-xl px-4 py-[26px] flex justify-between items-center",name:"thursday",label:"الخميس"}),a.jsx(t,{className:"w-full border border-[#E8E7EA] rounded-xl px-4 py-[26px] flex justify-between items-center",name:"friday",label:"الجمعة"}),a.jsx(t,{className:"w-full border border-[#E8E7EA] rounded-xl px-4 py-[26px] flex justify-between items-center",name:"saturday",label:"السبت"})]}),a.jsx(j,{text:"قواعد الحضور",className:"mt-6"}),a.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-4",children:[a.jsx(o,{name:"shift_start_time",label:"بداية الوردية",placeholder:"09:00",className:"flex flex-col"}),a.jsx(o,{name:"shift_end_time",label:"نهاية الوردية",placeholder:"17:00",className:"flex flex-col"}),a.jsx(o,{name:"early_entry_time",label:"بداية تسجيل الدخول",placeholder:"07:00",className:"flex flex-col"}),a.jsx(o,{name:"early_exit_time",label:"بداية تسجيل الخروج",placeholder:"15:00",className:"flex flex-col"}),a.jsx(o,{name:"late_entry_time",label:"فترة سماح التأخير:",placeholder:"15 د",className:"flex flex-col"}),a.jsx(o,{name:"late_exit_time",label:"فترة سماح التأخير (الخروج):",placeholder:"15 د",className:"flex flex-col"}),a.jsx(E,{name:"delay_minutes",type:"number",label:"التأخير",placeholder:"",className:"flex flex-col"}),a.jsx(E,{name:"delay_calculation_method",type:"number",label:"حساب التأخير",placeholder:"بعد بداية الوردية + مهلة التأخير",className:"flex flex-col"})]}),a.jsxs("div",{className:"flex flex-row justify-end gap-4 mt-6",children:[a.jsx(O,{type:"button",className:"text-base leading-5 tracking-normal !py-4 !px-16 bg-red-error-50 text-red-error-600 hover:text-white-blue-50 hover:bg-red-error-600  font-medium",children:"إلغاء"}),a.jsx(R,{type:"submit",className:"text-base leading-5 tracking-normal font-medium !py-4 !px-32",children:y?"جاري الحفظ...":"حفظ"})]})]})})})}export{te as A};
//# sourceMappingURL=AddShiftForm-Bc9-8PmD.js.map
