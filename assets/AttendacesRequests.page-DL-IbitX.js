import{r as n,b as D,j as e,e as g,t as v,k as C}from"./index-CG21Kl6L.js";import{U as S}from"./UnderlineHeading-6dFpHrZu.js";import{P as N}from"./PrimaryButton-CqSNXaEZ.js";import{C as _}from"./Dropdown-9zztjWeh.js";import{A as k}from"./AddIcon-tb5zEqxV.js";import{P as F}from"./PlusIcon-Bj6ya-hJ.js";import{D as A,a as E,b as P}from"./dialog-BNTutzAA.js";import{z as f,u as q,t as I,F as T}from"./index-CVKxZN6H.js";import{a as R,b as M}from"./axios-utils-DWLLXNPU.js";import{S as K}from"./SecondaryButton-C8PAsQMM.js";import{T as L}from"./TextAreaInputForm-DDtw8I0I.js";import{S as U}from"./SelectInputForm-nhbT-0nq.js";import{D as b}from"./DateInputForm-Bteneik4.js";import{f as y}from"./format-D6Kkl3rb.js";import{T as B}from"./TrashIcon-B-yPmS4K.js";import{F as V}from"./FileDownloadIcon-BUq89Jnb.js";import{D as G}from"./DeletePopup-Cp9aF88T.js";import{D as H}from"./data-table-q2Kgxvnv.js";import{S as J}from"./StatisticsCards-BHRSrF9_.js";import{U as h}from"./UserMinusIcon-Lbr4fSWK.js";import"./Combination-CF6sjIQ5.js";import"./index-DKOmws7K.js";import"./index-CVxAI6rk.js";import"./index-BuoIejD9.js";import"./index-Iw2dua5F.js";import"./chevron-right-ofNdHrp6.js";import"./textarea-C5nh8QJ5.js";import"./select-cvP0Sup0.js";import"./popover-GWOz0UH_.js";import"./chevron-left-Dd3efAkK.js";import"./CalendarIcon-vdySZVWB.js";import"./table-VHWg2bm3.js";import"./CustomPagination-CEeDQMqo.js";import"./pagination-B5K0ldzO.js";const O=f.object({start_date:f.date(),end_date:f.date(),vacation_type:f.string().min(1,"Vacation type field is required."),reason:f.string().min(1,"Reason field is required.")});function z({setShowPopup:t}){const[s,a]=n.useState(null),[c,l]=n.useState(!1),o=JSON.parse(D.get("user")||"{}").id,r=q({resolver:I(O)}),d=async x=>{var i,j;l(!0),a(null);const p={...x,employee_id:o,start_date:y(x.start_date,"yyyy-MM-dd"),end_date:y(x.end_date,"yyyy-MM-dd")};try{await R({endpoint:g.holiday.create,body:p,config:{headers:{"Content-Type":"multipart/form-data"}}}),v("تم اضافة الطلب بنجاح"),t(!1)}catch(u){if((j=(i=u.response)==null?void 0:i.data)!=null&&j.errors)Object.entries(u.response.data.errors).forEach(([m,w])=>{r.setError(m,{type:"manual",message:w.join(", ")})});else{let m="حدث خطأ أثناء إرسال البيانات. يرجى المحاولة مرة أخرى.";u.response?m=u.response.data.msg||m:u.request&&(m="تعذر الاتصال بالخادم. يرجى التحقق من اتصالك بالإنترنت."),a(m)}}finally{l(!1)}};return e.jsx(e.Fragment,{children:e.jsx(T,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(d),className:"mt-6",children:[s&&e.jsx("div",{className:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"",children:s}),e.jsx("button",{onClick:()=>a(null),className:"text-red-700 hover:text-red-900",children:"×"})]})}),e.jsx("div",{className:"grid grid-cols-2 gap-x-6",children:e.jsx(U,{name:"vacation_type",label:"نوع الاجازة",options:[{value:"sick",name:"اجازة طارئة"},{value:"annual",name:"اجازة مدنية"},{value:"religious",name:"اجازة اديانية"},{value:"other",name:"اجازة أخرى"}],placeholder:"اختر نوع الاجازة"})}),e.jsx(b,{name:"start_date",label:"بدء الاجازة",placeholder:"2004/04/30"}),e.jsx(b,{name:"end_date",label:"نهاية الاجازة",placeholder:"2004/04/30"}),e.jsx(L,{className:"flex flex-col min-h-[157px]",name:"reason",label:"ملاحظات",placeholder:"اكتب ملاحظات اضافية"}),e.jsxs("div",{className:"flex flex-row gap-4 mt-12",children:[e.jsx(K,{onClick:()=>t(!1),type:"button",className:"w-full text-base leading-5 tracking-normal py-[10px] font-medium",children:"إلغاء"}),e.jsx(N,{type:"submit",className:"w-full text-base leading-5 tracking-normal font-medium py-[10px]",children:c?"جاري الحفظ...":"تقديم الطلب"})]})]})})})}function Q({open:t,setShowPopup:s}){return e.jsxs(A,{open:t,children:[e.jsx("div",{className:C("fixed inset-0",{"!hidden":!t})}),e.jsxs(E,{showCloseButton:!1,className:"max-w-[623px] rounded-lg p-8 bg-white-blue-50 font-cairo gap-0 [&_[aria-label=Close]]:opacity-0",children:[e.jsxs(P,{className:"flex flex-col items-center",children:[e.jsx("div",{className:"flex flex-row justify-between mb-4 w-full",children:e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx(F,{}),e.jsx("h3",{className:"text-[22px] font-bold text-primery-blue-500",children:" طلب اجازة"})]})}),e.jsx("div",{className:"w-full border-b border-[#D1D1D1] !mt-0"})]}),e.jsx(z,{setShowPopup:s})]})]})}function W({globalFilter:t,setGlobalFilter:s,filters:a,setFilters:c}){const[l,o]=n.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col p-2 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx(S,{text:"قائمة طلبات الاجازات"}),e.jsxs("div",{className:"flex flex-row items-center gap-4",children:[e.jsx("div",{children:e.jsxs(N,{onClick:()=>o(!0),className:"text-base px-[14px] xl:py-2 leading-5 font-semibold font-cairo tracking-normal",children:[e.jsx(k,{}),e.jsx("p",{className:"text-xs tracking-normal font-normal leading-[22.49px]",children:"انشاء طلب شهادة"})]})}),e.jsx("div",{className:"flex fle-row items-center gap-4",children:e.jsx(_,{value:(a==null?void 0:a.status)||"",onValueChange:r=>{c({...a,status:r})},placeholder:"القائمة",width:"min-w-[77px]",options:[{label:"القائمة",value:""},{label:"متاح",value:"active"},{label:"غير متاح",value:"not active"}]})})]})]}),e.jsx(Q,{open:l,setShowPopup:o})]})}const X=({row:t})=>{const[s,a]=n.useState(!1),c=()=>{a(!0)},l=()=>{a(!1)},o=()=>{var r,d;v.success("تم حذف الفرع بنجاح"),a(!1),(d=(r=t.original).refreshTable)==null||d.call(r)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-row justify-center gap-6",children:[e.jsx(V,{className:"cursor-pointer text-primery-blue-400"}),e.jsx("button",{onClick:c,children:e.jsx(B,{className:"text-[#E81E1E] cursor-pointer"})})]}),s&&e.jsx(G,{open:s,text:"هل أنت متاكد أنك تريد حذف هذا الفرع",endpoint:g.holiday.delete+t.original.id,handleCancel:l,handleSuccess:o})]})},Y=[{accessorKey:"id",header:()=>e.jsx("div",{className:"text-sm px-4 py-3 !text-primery-blue-500 leading-[26.24px] font-semibold tracking-normal",children:"نوع الاجازة"}),cell:({row:t})=>e.jsx("div",{className:"text-sm text-[#625E74] font-normal tracking-normal leading-[26.4px]",children:t.original.vacation_type})},{accessorKey:"name",header:()=>e.jsxs("div",{className:"text-sm px-4 py-3 !text-primery-blue-500 leading-[26.24px] font-semibold tracking-normal",children:["من"," "]}),cell:({row:t})=>e.jsx("div",{className:"text-sm  font-normal tracking-normal leading-[26.4px]",children:t.original.start_date})},{accessorKey:"status",header:()=>e.jsxs("div",{className:"text-sm px-4 py-3 !text-primery-blue-500 leading-[26.24px] font-semibold tracking-normal",children:["الى"," "]}),cell:({row:t})=>e.jsx("div",{className:"text-xs font-medium tracking-normal leading-[115%]",children:t.original.end_date})},{accessorKey:"status",header:()=>e.jsxs("div",{className:"text-sm px-4 py-3 !text-primery-blue-500 leading-[26.24px] font-semibold tracking-normal",children:["الحالة"," "]}),cell:({row:t})=>e.jsx("div",{className:"text-xs text-white-blue-50 font-medium tracking-normal leading-[115%]",children:e.jsx("p",{className:"bg-[#22AD5C] p-1 w-fit rounded-sm",children:t.original.status})})},{accessorKey:"status",header:()=>e.jsx("div",{className:"text-sm px-4 py-3 !text-primery-blue-500 leading-[26.24px] font-semibold tracking-normal",children:"الملاحظات"}),cell:({row:t})=>e.jsx("div",{className:"text-xs font-medium tracking-normal leading-[115%]",children:t.original.reason})},{id:"actions",cell:({row:t})=>e.jsx(X,{row:t})}];function Z(){const[t,s]=n.useState([]),[a,c]=n.useState(0),[l,o]=n.useState(0),[r,d]=n.useState(!1),x=n.useCallback(async p=>{d(!0);try{const i=await M({endpoint:g.holiday.list,queryParams:{page:p.pageIndex+1,...p.filters,search:p.globalFilter}});s(i.data.data.data),c(Math.ceil(i.data.data.pagination.total/10)),o(i.data.data.pagination.total)}catch(i){console.error("Error fetching data:",i)}finally{d(!1)}},[]);return e.jsx("div",{className:"mt-6 mb-20 rounded-lg border border-[#E8E7EA] shadow-[0px_4px_4px_-1px_#0C0C0D0D,0px_4px_4px_-1px_#0C0C0D1A]",children:e.jsx(H,{columns:Y,data:t,pageCount:a,totalCount:l,onFetchData:x,DataTableToolbar:W,isLoading:r})})}function $(){const t=[{text:"عدد الطلبات",icon:e.jsx(h,{}),num:8,percent:-.3},{text:"تم الاصدار",icon:e.jsx(h,{}),num:8,percent:-.3},{text:"قيد المراجعة",icon:e.jsx(h,{}),num:3,percent:-.3},{text:"ملغي",icon:e.jsx(h,{}),num:3,percent:-.3}];return e.jsx(J,{cards:t,numJustifyStart:!0})}function ee(){return e.jsxs("div",{className:"w-full mt-6",children:[e.jsx($,{}),e.jsx(Z,{})]})}function Te(){return e.jsx("div",{className:"w-full mt-6 mb-24",children:e.jsx(ee,{})})}export{Te as default};
//# sourceMappingURL=AttendacesRequests.page-DL-IbitX.js.map
