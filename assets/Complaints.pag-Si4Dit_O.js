import{j as e,r,e as b,m as L,k as F,g as V,I as _,S as B,L as H}from"./index-CG21Kl6L.js";import{P as y}from"./PrimaryButton-CqSNXaEZ.js";import{A}from"./AddIcon-tb5zEqxV.js";import{S as I}from"./StatisticsCards-BHRSrF9_.js";import{b as N,a as S}from"./axios-utils-DWLLXNPU.js";import{S as P}from"./SecondaryButton-C8PAsQMM.js";import{S as Z}from"./SubtleButton-CIWvV8XM.js";import{T}from"./textarea-C5nh8QJ5.js";import{f as w}from"./format-D6Kkl3rb.js";import{C as q}from"./Dropdown-9zztjWeh.js";import{u as R}from"./useDebounce-YbtC9wqL.js";import"./Combination-CF6sjIQ5.js";import"./index-DKOmws7K.js";import"./index-CVxAI6rk.js";import"./index-BuoIejD9.js";import"./index-Iw2dua5F.js";import"./chevron-right-ofNdHrp6.js";const z=({width:s="40",height:l="40",className:t=""})=>e.jsx("span",{className:t,children:e.jsxs("svg",{width:s,height:l,viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{opacity:"0.4",d:"M26.9833 6.66602H13.0166C6.94992 6.66602 3.33325 10.2827 3.33325 16.3493V26.966C3.33325 33.0494 6.94992 36.666 13.0166 36.666H26.9666C33.0333 36.666 36.6499 33.0494 36.6499 26.9827V16.3493C36.6666 10.2827 33.0499 6.66602 26.9833 6.66602Z",fill:"#082743"}),e.jsx("path",{d:"M35.4999 20.3828H29.6999C28.0666 20.3828 26.6166 21.2828 25.8833 22.7495L24.4833 25.5161C24.1499 26.1828 23.4833 26.5995 22.7499 26.5995H17.2833C16.7666 26.5995 16.0333 26.4828 15.5499 25.5161L14.1499 22.7661C13.4166 21.3161 11.9499 20.3995 10.3333 20.3995H4.49992C3.84992 20.3995 3.33325 20.9161 3.33325 21.5661V26.9995C3.33325 33.0495 6.96659 36.6661 13.0333 36.6661H26.9999C32.7166 36.6661 36.2333 33.5328 36.6666 27.9661V21.5495C36.6666 20.9161 36.1499 20.3828 35.4999 20.3828Z",fill:"#011014"}),e.jsx("path",{d:"M24.2167 10.784C23.7334 10.3007 22.9334 10.3007 22.4501 10.784L21.2501 11.984V3.33398C21.2501 2.65065 20.6834 2.08398 20.0001 2.08398C19.3167 2.08398 18.7501 2.65065 18.7501 3.33398V11.984L17.5501 10.784C17.0667 10.3007 16.2667 10.3007 15.7834 10.784C15.3001 11.2673 15.3001 12.0673 15.7834 12.5507L19.1167 15.884C19.1334 15.9007 19.1501 15.9007 19.1501 15.9173C19.2501 16.0173 19.3834 16.1007 19.5167 16.1673C19.6834 16.2173 19.8334 16.2507 20.0001 16.2507C20.1667 16.2507 20.3167 16.2173 20.4667 16.1507C20.6167 16.084 20.7501 16.0007 20.8834 15.884L24.2167 12.5507C24.7001 12.0673 24.7001 11.2673 24.2167 10.784Z",fill:"#011014"})]})}),E=({width:s="40",height:l="40",className:t=""})=>e.jsx("span",{className:t,children:e.jsxs("svg",{width:s,height:l,viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{opacity:"0.4",d:"M36.6666 12.3841V22.3841C36.6666 24.8841 35.8332 26.9675 34.3666 28.4341C32.9166 29.8841 30.8333 30.7174 28.3333 30.7174V34.2675C28.3333 35.6008 26.8499 36.4008 25.7499 35.6675L18.3333 30.7174H14.7999C14.9333 30.2174 14.9999 29.7008 14.9999 29.1675C14.9999 27.4675 14.3499 25.9008 13.2833 24.7175C12.0833 23.3508 10.2999 22.5008 8.33325 22.5008C6.46659 22.5008 4.76659 23.2675 3.54993 24.5175C3.39993 23.8508 3.33325 23.1341 3.33325 22.3841V12.3841C3.33325 7.38411 6.66659 4.05078 11.6666 4.05078H28.3333C33.3333 4.05078 36.6666 7.38411 36.6666 12.3841Z",fill:"#011014"}),e.jsx("path",{d:"M25.8334 18.75H14.1667C13.4834 18.75 12.9167 18.1833 12.9167 17.5C12.9167 16.8167 13.4834 16.25 14.1667 16.25H25.8334C26.5167 16.25 27.0834 16.8167 27.0834 17.5C27.0834 18.1833 26.5167 18.75 25.8334 18.75Z",fill:"#011014"}),e.jsx("path",{d:"M8.33341 22.5C6.76675 22.5 5.31675 23.05 4.16675 23.9667C2.63341 25.1833 1.66675 27.0667 1.66675 29.1667C1.66675 32.85 4.65008 35.8333 8.33341 35.8333C10.0167 35.8333 11.5501 35.2 12.7334 34.1667C14.1168 32.95 15.0001 31.1667 15.0001 29.1667C15.0001 25.4833 12.0167 22.5 8.33341 22.5ZM10.0001 29.5833C10.0001 30.0167 9.76677 30.4334 9.40011 30.65L7.31677 31.9C7.11677 32.0167 6.90008 32.0833 6.66675 32.0833C6.25008 32.0833 5.83339 31.8667 5.60006 31.4834C5.25006 30.8834 5.43341 30.1166 6.03341 29.7666L7.51676 28.8834V27.0833C7.51676 26.4 8.08343 25.8333 8.76676 25.8333C9.4501 25.8333 10.0168 26.4 10.0168 27.0833V29.5833H10.0001Z",fill:"#011014"})]})});function G(){const[s,l]=r.useState(null);r.useEffect(()=>{(async()=>{try{const o=await N({endpoint:b.complaint.dashboard});l(o.data.data)}catch{l(null)}})()},[]);const t=[{text:"الرسائل الواردة",icon:e.jsx(z,{}),num:s==null?void 0:s.in_progress_complaints,percent:0},{text:"رسائل قيد الانتظار",icon:e.jsx(E,{}),num:s==null?void 0:s.pending_complaints,percent:0},{text:"رسائل تم الاجابة عليها",icon:e.jsx(E,{}),num:s==null?void 0:s.resolved_complaints,percent:0}];return e.jsx(I,{cards:t})}function J({apparentComplaint:s,refresh:l,setRefresh:t}){const[n,o]=r.useState(""),[c,i]=r.useState(null),[d,u]=r.useState(!1),x=async()=>{u(!0),i(null);try{await S({endpoint:b.complaint.update+(s==null?void 0:s.id),body:{answer:n,customer_id:s==null?void 0:s.customer.id},config:{headers:{"Content-Type":"multipart/form-data"}}}),o(""),i(null),t(!l)}catch(a){let m="حدث خطأ أثناء إرسال البيانات. يرجى المحاولة مرة أخرى.";a.response?m=a.response.data.msg||m:a.request&&(m="تعذر الاتصال بالخادم. يرجى التحقق من اتصالك بالإنترنت."),i(m)}finally{u(!1)}};return e.jsxs("div",{className:"px-4 mt-3",children:[e.jsxs("div",{className:"rounded-lg border border-[#93919F] p-2",children:[e.jsx(T,{placeholder:"نص رسالة جديدة....",className:"text-[#575155] placeholder:text-[#2D364880] text-base font-medium tracking-normal border-none shadow-none resize-none mb-[10px] custom-scrollbar",onChange:a=>o(a.target.value),value:n}),e.jsx(Z,{disabled:n.trim().length<1,className:"block ms-auto w-32 h-11",onClick:x,children:d?"جاري التحميل...":"رد"})]}),c&&e.jsx("div",{className:"mt-3 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"",children:c}),e.jsx("button",{onClick:()=>i(null),className:"text-red-700 hover:text-red-900",children:"×"})]})})]})}function K({apparentComplaint:s,setِِِِِِِِِApparentComplaint:l,refresh:t,setRefresh:n}){const[o,c]=r.useState(null),[i,d]=r.useState(!1),u=async()=>{d(!0),c(null);try{await S({endpoint:b.complaint.update+(s==null?void 0:s.id),body:{status:"resolved",customer_id:s==null?void 0:s.customer.id},config:{headers:{"Content-Type":"multipart/form-data"}}}),c(null),n(!t)}catch(x){let a="حدث خطأ أثناء إرسال البيانات. يرجى المحاولة مرة أخرى.";x.response?a=x.response.data.msg||a:x.request&&(a="تعذر الاتصال بالخادم. يرجى التحقق من اتصالك بالإنترنت."),c(a)}finally{d(!1)}};return s?e.jsxs("div",{className:"w-2/3 rounded-xl overflow-hidden",children:[e.jsxs("div",{className:"bg-primery-blue-50 px-4 py-2 flex flex-row items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex flex-row items-center justify-between gap-7",children:[e.jsx("img",{className:"w-10 h-10 rounded-full",src:L,alt:""}),e.jsxs("div",{className:"flex flex-col items-start justify-center gap-2",children:[e.jsx("p",{className:"text-sm font-normal text-[#120E2B] tracking-normal",children:s.customer.full_name}),e.jsx("p",{className:"text-sm font-normal text-[#70686D] tracking-normal",children:"نوع وتاريخ العضوية"})]})]}),e.jsx("div",{className:"text-sm font-normal text-[#70686D] tracking-normal",children:w(new Date(s.created_at),"dd/MM/yyyy")})]}),e.jsxs("div",{className:"flex flex-col gap-4 px-4 pt-2",children:[e.jsx("p",{className:"text-base font-semibold text-[#100147] tracking-normal",children:"تفاصيل الشكوى"}),e.jsxs("div",{className:"flex flex-row gap-4",children:[e.jsx("p",{className:"text-base w-[110px] font-semibold text-[#100147] tracking-normal",children:"رقم الشكوى"}),e.jsx("p",{className:"bg-[#F5F4F5] w-[195px] border border-[#E1DEE0] text-[#9E939A] text-xs font-semibold tracking-normal px-4 py-2",children:s.id})]}),e.jsxs("div",{className:"flex flex-row gap-4",children:[e.jsx("p",{className:"text-base w-[110px] font-semibold text-[#100147] tracking-normal",children:"تاريخ الشكوى"}),e.jsx("p",{className:"bg-[#F5F4F5] w-[195px] border border-[#E1DEE0] text-[#9E939A] text-xs font-semibold tracking-normal px-4 py-2",children:w(new Date(s.created_at),"dd/MM/yyyy")})]}),e.jsxs("div",{className:"flex flex-row gap-4",children:[e.jsx("p",{className:"text-base w-[110px] font-semibold text-[#100147] tracking-normal",children:"حالة الشكوى"}),e.jsx("p",{className:"bg-[#D1FAE5] w-[195px] border border-[#E1DEE0] text-[#065F46] text-xs text-center font-semibold tracking-normal px-4 py-2",children:s.status})]})]}),e.jsxs("div",{className:"mt-7 px-4",children:[e.jsx("p",{className:"text-base font-semibold text-[#100147] tracking-normal mb-4",children:"نص الشكوى"}),e.jsx("p",{dangerouslySetInnerHTML:{__html:s.description},className:"border border-[#E8E7EA] rounded-lg p-2 max-h-[480px] custom-scrollbar overflow-y-auto text-[#575155] text-base font-medium tracking-normal"})]}),e.jsx("div",{children:e.jsxs("div",{className:"mt-7 px-4",children:[e.jsx("p",{className:"text-base font-semibold text-[#100147] tracking-normal mb-4",children:"الرد"}),e.jsx("p",{className:"border border-[#E8E7EA] rounded-lg p-2 max-h-[480px] custom-scrollbar overflow-y-auto text-[#575155] text-base font-medium tracking-normal",children:s==null?void 0:s.answer})]})}),e.jsx(J,{apparentComplaint:s,refresh:t,setRefresh:n}),o&&e.jsx("div",{className:"px-4",children:e.jsx("div",{className:"mt-3 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"",children:o}),e.jsx("button",{onClick:()=>c(null),className:"text-red-700 hover:text-red-900",children:"×"})]})})}),e.jsxs("div",{className:"flex flex-row justify-end items-start gap-6 p-2 mt-3",children:[e.jsx(P,{className:"xl:px-10",children:"تحويل الى قسم اخر"}),e.jsx(y,{disabled:s.status==="resolved",onClick:u,className:"xl:px-24",children:i?"جاري التحميل...":"إغلاق الشكوى"})]})]}):null}function O({complaint:s,setِِِِِِِِِApparentComplaint:l,apparentComplaint:t}){const n=()=>{l(s)};return e.jsxs("div",{onClick:n,className:F("flex flex-col justify-between cursor-pointer gap-2 bg-white-blue-50 p-4 border-b border-[#D2CDD1] transition-all duration-200",{"bg-primery-blue-50":(t==null?void 0:t.id)===s.id}),children:[e.jsxs("div",{className:"flex flex-row justify-between items-center",children:[e.jsx("p",{className:"text-sm font-normal text-[#120E2B] tracking-normal",children:s.customer.full_name}),e.jsx("div",{className:"w-[14px] h-[14px] bg-[#FEE2E2] rounded-full"})]}),e.jsxs("div",{className:"flex flex-row justify-between items-center",children:[e.jsx("p",{className:"text-xs font-normal text-[#70686D] tracking-normal",children:s.title}),e.jsx("span",{className:"text-[9px] font-normal text-[#70686D] tracking-normal",children:w(new Date(s.created_at),"dd/MM/yyyy")})]})]})}function Q({setِِِِِِِِِApparentComplaint:s,apparentComplaint:l,complaints:t,currentPage:n,error:o,loading:c,pagination:i,filterValue:d,setCurrentPage:u,setPagination:x,setSearch:a,setFilterValue:m}){const g=()=>{u(n+1)},p=f=>{a(f.target.value),x(null)},j=f=>{m(f),x(null)};return c?e.jsx(V,{}):o?e.jsx("div",{className:"mt-6 mb-[102px] text-center py-20",children:e.jsx("h2",{className:"text-xl text-red-500",children:o})}):t?e.jsx("div",{className:"w-1/3",children:e.jsxs("div",{className:"rounded-[13px] overflow-hidden",children:[e.jsx("div",{className:"bg-primery-blue-50 px-4 py-[13px]",children:e.jsxs("div",{className:"flex flex-row items-center gap-2",children:[e.jsxs("div",{className:"flex flex-row items-center w-full h-10 border border-white-blue-300 bg-white-blue-50 p-2 rounded-[6px]",children:[e.jsx(_,{placeholder:"ابحث باسم  العميل",className:"text-white-blue-800 p-0 tracking-normal text-base font-normal border-none outline-none focus-visible:ring-0 placeholder:text-[#B6B5BF]",onChange:p}),e.jsx("button",{className:"bg-transparent border-none",children:e.jsx(B,{className:"text-[#B6B5BF]"})})]}),e.jsx(q,{options:[{label:"معلقه",value:"pending"},{label:"قيد التقدم",value:"in_progress"},{label:"تم حلها",value:"resolved"},{label:"الكل",value:""}],value:d,onValueChange:j,placeholder:"الحاله",width:"min-w-[77px]",className:"h-10"})]})}),e.jsxs("div",{className:"border border-[#E8E7EA] max-h-[740px] overflow-y-auto custom-scrollbar",children:[t.map(f=>e.jsx(O,{complaint:f,setِِِِِِِِِApparentComplaint:s,apparentComplaint:l},f.id)),t.length===0&&e.jsx("div",{className:"text-center py-20",children:e.jsx("h2",{className:"text-xl",children:"لا توجد نتائج لعرضها"})}),i&&t.length<i.total&&e.jsx("div",{className:"flex justify-center mt-4",children:e.jsx(y,{onClick:g,className:"text-base font-normal",children:"تحميل المزيد"})})]})]})}):e.jsx("div",{className:"mt-6 w-1/3 mb-[102px] text-center py-20",children:e.jsx("h2",{className:"text-xl",children:"Complaints not found"})})}function U(){const[s,l]=r.useState(null),[t,n]=r.useState(1),[o,c]=r.useState(!0),[i,d]=r.useState(null),[u,x]=r.useState(null),[a,m]=r.useState(null),[g,p]=r.useState(""),[j,f]=r.useState(""),[v,k]=r.useState(!1),C=R(g,150);return r.useEffect(()=>{(async()=>{try{const h=await N({endpoint:b.complaint.list,queryParams:{page:t,search:C,status:j}});x(D=>t===1?h.data.data.data:[...D||[],...h.data.data.data]),m(h.data.data.pagination)}catch{d("Failed to load complaints details")}finally{c(!1)}})()},[t,C,j]),r.useEffect(()=>{s&&(async()=>{try{const h=await N({endpoint:b.complaint.show+s.id,queryParams:{page:t,search:g,status:j}});l(h.data.data),d(null)}catch{d("Failed to load complaint details")}})()},[v]),e.jsxs("div",{className:"mt-6 w-full flex flex-row gap-6 mb-10",children:[e.jsx(Q,{setِِِِِِِِِApparentComplaint:l,apparentComplaint:s,complaints:u,currentPage:t,error:i,loading:o,pagination:a,filterValue:j,setCurrentPage:n,setPagination:m,setSearch:p,setFilterValue:f}),e.jsx(K,{apparentComplaint:s,setِِِِِِِِِApparentComplaint:l,setRefresh:k,refresh:v})]})}function ue(){return e.jsxs("div",{className:"mt-6 w-full",children:[e.jsx(G,{}),e.jsxs("div",{className:"flex flex-row items-center justify-between mt-6",children:[e.jsx("h1",{className:"font-bold text-[#080614] text-[24px] tracking-normal",children:"قائمة الشكاوي"}),e.jsx(H,{to:"/customer-relations/complaints/add",children:e.jsxs(y,{className:"!px-[25px] !py-3",children:[e.jsx(A,{}),"تسجيل شكوى جديدة"]})})]}),e.jsx(U,{})]})}export{ue as default};
//# sourceMappingURL=Complaints.pag-Si4Dit_O.js.map
