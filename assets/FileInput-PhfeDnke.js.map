{"version":3,"file":"FileInput-PhfeDnke.js","sources":["../../src/features/hrSelfServices/forms/FileInput.tsx"],"sourcesContent":["import { useFormContext } from 'react-hook-form';\r\nimport { FormField, FormItem, FormLabel, FormControl, FormMessage } from '@/components/ui/form';\r\nimport { useDropzone } from 'react-dropzone';\r\nimport { SecondaryButton } from '@/components/buttons/SecondaryButton';\r\nimport { useEffect, useState } from 'react';\r\nimport removeDuplicates from '@/utils/removeDuplicated';\r\n\r\ninterface Props {\r\n    className?: string;\r\n    name: string;\r\n    label?: string;\r\n    multiple: boolean;\r\n    maxSize: number;\r\n    editImages?: string[] | string;\r\n}\r\n\r\nconst FileInput = ({ className, name, label, maxSize, multiple, editImages }: Props) => {\r\n    const { control, setValue, watch, getValues } = useFormContext();\r\n    const [imgPreviews, setImgPreviews] = useState<string[]>([]);\r\n\r\n    const removeImage = (index: number) => {\r\n        const currentFiles = getValues(name);\r\n        const newFiles = Array.isArray(currentFiles) ? currentFiles.filter((_, i) => i !== index) : [];\r\n\r\n        setValue(name, newFiles, { shouldValidate: true });\r\n\r\n        setImgPreviews((prev) => {\r\n            const newPreviews = prev.filter((_, i) => {\r\n                if (i === index) {\r\n                    URL.revokeObjectURL(prev[i]);\r\n                }\r\n                return i !== index;\r\n            });\r\n            return newPreviews;\r\n        });\r\n    };\r\n\r\n    const onDrop = (acceptedFiles: File[], name: string) => {\r\n        if (multiple && editImages) {\r\n            // Get current files from form value\r\n            const currentValue = getValues(name);\r\n            const existingFiles = Array.isArray(currentValue) ? currentValue : [];\r\n            // Merge existing files with new accepted files\r\n            const combinedFiles = [...existingFiles, ...acceptedFiles];\r\n            setValue(name, removeDuplicates(combinedFiles), { shouldValidate: true });\r\n            // Generate previews for new files and append\r\n            const newPreviews = acceptedFiles.map((file) => URL.createObjectURL(file));\r\n            setImgPreviews((prev) => [...prev, ...newPreviews]);\r\n        } else {\r\n            setValue(name, multiple ? acceptedFiles : acceptedFiles[0], { shouldValidate: true });\r\n            setImgPreviews(acceptedFiles.map((file) => URL.createObjectURL(file)));\r\n        }\r\n    };\r\n\r\n    // Watch the form values for images\r\n    const images = watch(name);\r\n\r\n    // Reset previews when form values are cleared\r\n    useEffect(() => {\r\n        if (!images || images.length === 0) {\r\n            setImgPreviews([]);\r\n        }\r\n    }, [images]);\r\n\r\n    // initailly add editImages to react hook form state when edit\r\n    useEffect(() => {\r\n        if (editImages) {\r\n            setValue(name, editImages, { shouldValidate: true });\r\n            setImgPreviews(Array.isArray(editImages) ? editImages : [editImages]);\r\n        }\r\n    }, []);\r\n\r\n    return (\r\n        <FormField\r\n            control={control}\r\n            name={name}\r\n            render={({ field }) => (\r\n                <FormItem className={className}>\r\n                    <FormLabel className=\"text-primery-blue-900 font-medium text-[18px] leading-[33.73px] tracking-normal text-start\">\r\n                        {label}\r\n                    </FormLabel>\r\n                    <FormControl>\r\n                        <ImgFileUploader\r\n                            onDrop={(files: File[]) => onDrop(files, name)}\r\n                            acceptedFiles={field.value}\r\n                            previews={imgPreviews}\r\n                            maxSize={maxSize}\r\n                            multiple={multiple}\r\n                            removeImage={removeImage}\r\n                        />\r\n                    </FormControl>\r\n                    <FormMessage />\r\n                </FormItem>\r\n            )}\r\n        />\r\n    );\r\n};\r\n\r\nexport default FileInput;\r\n\r\nfunction ImgFileUploader({ onDrop, previews, maxSize, multiple, removeImage }: any) {\r\n    const { getRootProps, getInputProps } = useDropzone({\r\n        onDrop,\r\n        accept: { 'application/pdf': [], 'image/*': [] },\r\n        multiple: multiple,\r\n        maxSize: maxSize,\r\n    });\r\n\r\n    return (\r\n        <div\r\n            {...getRootProps()}\r\n            className=\"border-2 border-dashed border-primery-blue-500 rounded-lg p-4 text-center cursor-pointer\"\r\n        >\r\n            <input {...getInputProps()} />\r\n            <div>\r\n                <div className=\"flex flex-row items-center justify-between text-base leading-5 tracking-normal font-medium\">\r\n                    <div className=\"flex flex-row items-center gap-2 mb-5\">\r\n                        <svg width=\"32\" height=\"32\" viewBox=\"0 0 32 32\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                            <path\r\n                                d=\"M10.7521 23.4006C10.366 25.0819 8.41456 26.783 6.31738 25.3982C6.31738 25.3982 7.67526 26.605 10.4333 26.605H22.4646C23.9666 26.605 25.2654 25.5577 25.5843 24.0894L27.0886 16.6907C27.5357 14.373 26.0064 13.2734 23.9703 13.2734H15.5231C14.0248 13.2734 12.7272 14.3158 12.4059 15.7791L10.7521 23.4006Z\"\r\n                                stroke=\"#145DA0\"\r\n                                strokeWidth=\"1.44\"\r\n                                strokeLinecap=\"round\"\r\n                                strokeLinejoin=\"round\"\r\n                            />\r\n                            <path\r\n                                d=\"M10.4339 26.6056C6.46498 26.6056 4.12744 24.2731 4.12744 20.314V11.685C4.12744 7.73098 5.58202 5.39844 9.54101 5.39844H11.754C12.5485 5.39844 13.2958 5.77329 13.7715 6.40842L14.7815 7.75215C15.2597 8.38605 16.0081 8.75965 16.8026 8.76214H18.6707C22.0917 8.76214 23.6522 10.2628 24.017 13.2641\"\r\n                                stroke=\"#145DA0\"\r\n                                strokeWidth=\"1.44\"\r\n                                strokeLinecap=\"round\"\r\n                                strokeLinejoin=\"round\"\r\n                            />\r\n                        </svg>\r\n\r\n                        <p className=\"font-medium text-sm text-[#2D2D3A]\">قم برفع ملف أو قم سحبه هنا</p>\r\n                    </div>\r\n                    <SecondaryButton type=\"button\" className=\"h-[30px]\">\r\n                        اختيار الملف\r\n                    </SecondaryButton>\r\n                </div>\r\n                <div className=\"flex flex-row justify-center gap-2 border-2 border-dashed border-primery-blue-500 rounded-lg p-8\">\r\n                    {previews?.map((preview: any, index: number) => (\r\n                        <div\r\n                            key={index}\r\n                            className=\"relative group flex flex-col items-center text-sm text-muted-foreground\"\r\n                        >\r\n                            <img\r\n                                src={preview}\r\n                                alt={`Preview ${index + 1}`}\r\n                                className=\"w-20 h-20 object-cover rounded-md\"\r\n                            />\r\n                            \r\n                            <button\r\n                                type=\"button\"\r\n                                onClick={(e) => {\r\n                                    e.stopPropagation();\r\n                                    removeImage(index);\r\n                                }}\r\n                                className=\"absolute w-6 h-6 top-1 start-1 bg-red-error-600 text-white-blue-50 p-1 rounded-full text-xs opacity-0 group-hover:opacity-100 transition-opacity\"\r\n                            >\r\n                                ✕\r\n                            </button>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n                <div>\r\n                    <ul className=\"text-xs leading-[22.5px] font-medium tracking-normal text-start text-[#90868C] list-[square] marker:text-[8px] ps-5 mt-2\">\r\n                        <li>\r\n                            اقصى حجم <span className=\"font-bold ms-[2px]\">{maxSize / 1024 / 1024}MB</span>\r\n                        </li>\r\n                        <li>\r\n                            الملفات المسموح بها<span className=\"font-bold ms-[2px]\">pdf</span>\r\n                        </li>\r\n                    </ul>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":["FileInput","className","name","label","maxSize","multiple","editImages","control","setValue","watch","getValues","useFormContext","imgPreviews","setImgPreviews","useState","removeImage","index","currentFiles","newFiles","_","i","prev","onDrop","acceptedFiles","currentValue","combinedFiles","removeDuplicates","newPreviews","file","images","useEffect","jsx","FormField","field","jsxs","FormItem","FormLabel","FormControl","ImgFileUploader","files","FormMessage","previews","getRootProps","getInputProps","useDropzone","SecondaryButton","preview","e"],"mappings":"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"}